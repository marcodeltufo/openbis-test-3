    

<!DOCTYPE html>
<html lang="en-GB" >
<head>
                            <title>Installation and Administrators Guide of the openBIS Data Store Server - openBIS Documentation Rel. 20.10 - Confluence</title>
    
        

                        
    
                        
    

                
    
    <meta http-equiv="X-UA-Compatible" content="IE=EDGE,chrome=IE7">
<meta charset="UTF-8">
<meta id="confluence-context-path" name="confluence-context-path" content="">
<meta id="confluence-base-url" name="confluence-base-url" content="https://unlimited.ethz.ch">

    <meta id="atlassian-token" name="atlassian-token" content="6501f896af3a81ce3fbdd7c507e517d1c13dbca7">


<meta id="confluence-space-key" name="confluence-space-key" content="openBISDoc2010">
<script type="text/javascript">
        var contextPath = '';
</script>

    

    <meta name="confluence-request-time" content="1684321578531">
        
    
        
            <style>.ia-fixed-sidebar, .ia-splitter-left {width: 285px;}.theme-default .ia-splitter #main {margin-left: 285px;}.ia-fixed-sidebar {visibility: hidden;}</style>
            <meta name="ajs-use-keyboard-shortcuts" content="true">
            <meta name="ajs-discovered-plugin-features" content="$discoveredList">
            <meta name="ajs-keyboardshortcut-hash" content="648714ce17fa7d52f9a989833ba16e6">
            <meta id="team-calendars-has-jira-link" content="true">
            <meta name="ajs-team-calendars-display-time-format" content="displayTimeFormat24">
            <meta id="team-calendars-display-week-number" content="true">
            <meta id="team-calendars-user-timezone" content="Europe/Zurich">
            <script type="text/x-template" id="team-calendars-messages" title="team-calendars-messages"><fieldset class="i18n hidden"><input type="hidden" name="calendar3.month.long.july" value="July"><input type="hidden" name="calendar3.day.short.wednesday" value="Wed"><input type="hidden" name="calendar3.day.short.thursday" value="Thu"><input type="hidden" name="calendar3.month.short.march" value="Mar"><input type="hidden" name="calendar3.month.long.april" value="April"><input type="hidden" name="calendar3.month.long.october" value="October"><input type="hidden" name="calendar3.month.long.august" value="August"><input type="hidden" name="calendar3.month.short.july" value="Jul"><input type="hidden" name="calendar3.month.short.may" value="May"><input type="hidden" name="calendar3.month.short.november" value="Nov"><input type="hidden" name="calendar3.day.long.friday" value="Friday"><input type="hidden" name="calendar3.day.long.sunday" value="Sunday"><input type="hidden" name="calendar3.day.long.saturday" value="Saturday"><input type="hidden" name="calendar3.month.short.april" value="Apr"><input type="hidden" name="calendar3.day.long.wednesday" value="Wednesday"><input type="hidden" name="calendar3.month.long.december" value="December"><input type="hidden" name="calendar3.month.short.october" value="Oct"><input type="hidden" name="calendar3.day.long.monday" value="Monday"><input type="hidden" name="calendar3.month.short.june" value="Jun"><input type="hidden" name="calendar3.day.short.monday" value="Mon"><input type="hidden" name="calendar3.day.short.tuesday" value="Tue"><input type="hidden" name="calendar3.day.short.saturday" value="Sat"><input type="hidden" name="calendar3.month.long.march" value="March"><input type="hidden" name="calendar3.month.long.june" value="June"><input type="hidden" name="calendar3.month.short.february" value="Feb"><input type="hidden" name="calendar3.month.short.august" value="Aug"><input type="hidden" name="calendar3.month.short.december" value="Dec"><input type="hidden" name="calendar3.day.short.sunday" value="Sun"><input type="hidden" name="calendar3.month.long.february" value="February"><input type="hidden" name="calendar3.day.long.tuesday" value="Tuesday"><input type="hidden" name="calendar3.month.long.may" value="May"><input type="hidden" name="calendar3.month.long.september" value="September"><input type="hidden" name="calendar3.month.long.november" value="November"><input type="hidden" name="calendar3.month.short.january" value="Jan"><input type="hidden" name="calendar3.month.short.september" value="Sep"><input type="hidden" name="calendar3.day.long.thursday" value="Thursday"><input type="hidden" name="calendar3.month.long.january" value="January"><input type="hidden" name="calendar3.day.short.friday" value="Fri"></fieldset></script>
            <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: { inlineMath: [ ['(mathjax-inline(', ')mathjax-inline)' ] ], displayMath: [ ['(mathjax-block(', ')mathjax-block)' ] ], }, asciimath2jax: { delimiters: [ ['(mathjax-ascii-math(',')mathjax-ascii-math)'] ] } }); </script> <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
            <meta name="ajs-is-confluence-admin" content="false">
            <meta name="ajs-connection-timeout" content="10000">
            
    
    
            <meta name="ajs-page-title" content="Installation and Administrators Guide of the openBIS Data Store Server">
            <meta name="ajs-latest-published-page-title" content="Installation and Administrators Guide of the openBIS Data Store Server">
            <meta name="ajs-space-name" content="openBIS Documentation Rel. 20.10">
            <meta name="ajs-page-id" content="53745995">
            <meta name="ajs-latest-page-id" content="53745995">
            <meta name="ajs-content-type" content="page">
            <meta name="ajs-parent-page-title" content="Guides">
            <meta name="ajs-parent-page-id" content="53746006">
            <meta name="ajs-space-key" content="openBISDoc2010">
            <meta name="ajs-max-number-editors" content="12">
            <meta name="ajs-macro-placeholder-timeout" content="5000">
            <meta name="ajs-jira-metadata-count" content="-1">
            <meta name="ajs-from-page-title" content="">
            <meta name="ajs-can-remove-page" content="false">
            <meta name="ajs-can-remove-page-hierarchy" content="false">
            <meta name="ajs-browse-page-tree-mode" content="view">
            <meta name="ajs-shared-drafts" content="true">
            <meta name="ajs-context-path" content="">
            <meta name="ajs-base-url" content="https://unlimited.ethz.ch">
            <meta name="ajs-version-number" content="8.2.0">
            <meta name="ajs-build-number" content="9004">
            <meta name="ajs-remote-user" content="">
            <meta name="ajs-remote-user-key" content="">
            <meta name="ajs-remote-user-has-licensed-access" content="false">
            <meta name="ajs-remote-user-has-browse-users-permission" content="false">
            <meta name="ajs-current-user-fullname" content="">
            <meta name="ajs-current-user-avatar-uri-reference" content="/images/icons/profilepics/anonymous.svg">
            <meta name="ajs-static-resource-url-prefix" content="/s/v0cs71/9004/9r8qvy/_">
            <meta name="ajs-global-settings-attachment-max-size" content="157286400">
            <meta name="ajs-global-settings-quick-search-enabled" content="true">
            <meta name="ajs-user-locale" content="en_GB">
            <meta name="ajs-enabled-dark-features" content="site-wide.shared-drafts,site-wide.synchrony,clc.quick.create,confluence.view.edit.transition,cql.search.screen,confluence-inline-comments-resolved,http.session.registrar,nps.survey.inline.dialog,confluence.efi.onboarding.new.templates,atlassian.cdn.static.assets,pdf-preview,previews.sharing,previews.versions,file-annotations,confluence.efi.onboarding.rich.space.content,collaborative-audit-log,confluence.reindex.improvements,previews.conversion-service,editor.ajax.save,crowd.sync.nested.groups.group.membership.changes.batching.enabled,read.only.mode,graphql,previews.trigger-all-file-types,attachment.extracted.text.extractor,lucene.caching.filter,confluence.table.resizable,notification.batch,previews.sharing.pushstate,confluence-inline-comments-rich-editor,tc.tacca.dacca,site-wide.synchrony.opt-in,atlassian.webresource.twophase.js.i18n.disabled,confluence.denormalisedpermissions,file-annotations.likes,gatekeeper-ui-v2,v2.content.name.searcher,confluence.search.improvements.ranking,crowd.event.transformer.directory.manager.cache,mobile.supported.version,pulp,crowd.sync.delete.user.memberships.batching.enabled,confluence-inline-comments,confluence-inline-comments-dangling-comment,quick-reload-inline-comments-flags,confluence.retention.rules">
            <meta name="ajs-atl-token" content="6501f896af3a81ce3fbdd7c507e517d1c13dbca7">
            <meta name="ajs-confluence-flavour" content="VANILLA">
            <meta name="ajs-user-date-pattern" content="dd MMM yyyy">
            <meta name="ajs-access-mode" content="READ_WRITE">
            <meta name="ajs-render-mode" content="READ_WRITE">
            <meta name="ajs-date.format" content="MMM dd, yyyy">
    
    <link rel="shortcut icon" href="/s/-5iwf5w/9004/9r8qvy/8/_/favicon.ico">
    <link rel="icon" type="image/x-icon" href="/s/-5iwf5w/9004/9r8qvy/8/_/favicon.ico">

<link rel="search" type="application/opensearchdescription+xml" href="/opensearch/osd.action" title="Confluence"/>
    
                    
            <meta name="ajs-create-issue-metadata-show-discovery" content="false">
            

    <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};window.WRM._unparsedErrors=window.WRM._unparsedErrors||{};
WRM._unparsedData["com.atlassian.applinks.applinks-plugin:applinks-common-exported.entity-types"]="{\u0022singular\u0022:{\u0022refapp.charlie\u0022:\u0022Charlie\u0022,\u0022fecru.project\u0022:\u0022Crucible Project\u0022,\u0022fecru.repository\u0022:\u0022FishEye Repository\u0022,\u0022stash.project\u0022:\u0022Stash Project\u0022,\u0022generic.entity\u0022:\u0022Generic Project\u0022,\u0022confluence.space\u0022:\u0022Confluence Space\u0022,\u0022bamboo.project\u0022:\u0022Bamboo Project\u0022,\u0022jira.project\u0022:\u0022Jira Project\u0022},\u0022plural\u0022:{\u0022refapp.charlie\u0022:\u0022Charlies\u0022,\u0022fecru.project\u0022:\u0022Crucible Projects\u0022,\u0022fecru.repository\u0022:\u0022FishEye Repositories\u0022,\u0022stash.project\u0022:\u0022Stash Projects\u0022,\u0022generic.entity\u0022:\u0022Generic Projects\u0022,\u0022confluence.space\u0022:\u0022Confluence Spaces\u0022,\u0022bamboo.project\u0022:\u0022Bamboo Projects\u0022,\u0022jira.project\u0022:\u0022Jira Projects\u0022}}";
WRM._unparsedData["com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider"]="false";
WRM._unparsedData["com.atlassian.confluence.plugins.confluence-license-banner:confluence-license-banner-resources.license-details"]="{\u0022daysBeforeLicenseExpiry\u0022:0,\u0022daysBeforeMaintenanceExpiry\u0022:0,\u0022showLicenseExpiryBanner\u0022:false,\u0022showMaintenanceExpiryBanner\u0022:false,\u0022renewUrl\u0022:null,\u0022salesUrl\u0022:null}";
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\u0022\u0022";
WRM._unparsedData["com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider"]="false";
WRM._unparsedData["com.atlassian.applinks.applinks-plugin:applinks-common-exported.authentication-types"]="{\u0022com.atlassian.applinks.api.auth.types.BasicAuthenticationProvider\u0022:\u0022Basic Access\u0022,\u0022com.atlassian.applinks.api.auth.types.TrustedAppsAuthenticationProvider\u0022:\u0022Trusted Applications\u0022,\u0022com.atlassian.applinks.api.auth.types.CorsAuthenticationProvider\u0022:\u0022CORS\u0022,\u0022com.atlassian.applinks.api.auth.types.OAuthAuthenticationProvider\u0022:\u0022OAuth\u0022,\u0022com.atlassian.applinks.api.auth.types.TwoLeggedOAuthAuthenticationProvider\u0022:\u0022OAuth\u0022,\u0022com.atlassian.applinks.api.auth.types.TwoLeggedOAuthWithImpersonationAuthenticationProvider\u0022:\u0022OAuth\u0022}";
WRM._unparsedData["com.atlassian.confluence.plugins.confluence-search-ui-plugin:confluence-search-ui-plugin-resources.i18n-data"]="{\u0022search.ui.recent.link.text\u0022:\u0022View more recently visited\u0022,\u0022search.ui.search.results.empty\u0022:\u0022We couldn\u0027\u0027t find anything matching \u005C\u0022{0}\u005C\u0022.\u0022,\u0022search.ui.filter.clear.selected\u0022:\u0022Clear selected items\u0022,\u0022search.ui.content.name.search.items.panel.load.all.top.items.button.text\u0022:\u0022Show more app results...\u0022,\u0022search.ui.filter.contributor.button.text\u0022:\u0022Contributor\u0022,\u0022search.ui.filter.space.current.label\u0022:\u0022CURRENT\u0022,\u0022search.ui.clear.input.button.text\u0022:\u0022Clear text\u0022,\u0022search.ui.search.results.clear.button\u0022:\u0022clear your filters.\u0022,\u0022help.search.ui.link.title\u0022:\u0022Search tips\u0022,\u0022search.ui.container.close.text\u0022:\u0022Close\u0022,\u0022search.ui.filter.date.month.text\u0022:\u0022The past month\u0022,\u0022search.ui.infinite.scroll.button.text\u0022:\u0022More results\u0022,\u0022search.ui.filter.date.button.text\u0022:\u0022Date\u0022,\u0022search.ui.filter.date.week.text\u0022:\u0022The past week\u0022,\u0022search.ui.result.subtitle.calendar\u0022:\u0022Team calendar\u0022,\u0022search.ui.filter.date.heading\u0022:\u0022Last modified within\u0022,\u0022search.ui.filter.space.input.label\u0022:\u0022Find spaces...\u0022,\u0022search.ui.generic.error\u0022:\u0022Something went wrong. Refresh the page, or contact your admin if this keeps happening.\u0022,\u0022search.ui.recent.spaces\u0022:\u0022Recent Spaces\u0022,\u0022search.ui.result.subtitle.space\u0022:\u0022Space\u0022,\u0022search.ui.filter.space.category.input.label\u0022:\u0022Find space categories...\u0022,\u0022search.ui.filter.space.archive.label\u0022:\u0022Search archived spaces\u0022,\u0022search.ui.filter.label\u0022:\u0022filter\u0022,\u0022search.ui.filter.date.all.text\u0022:\u0022Any time\u0022,\u0022search.ui.filter.date.hour.text\u0022:\u0022The past day\u0022,\u0022search.ui.filters.heading\u0022:\u0022Filter by\u0022,\u0022search.ui.filter.label.input.label\u0022:\u0022Find labels...\u0022,\u0022search.ui.recent.items.anonymous\u0022:\u0022Start exploring. Your search results will appear here.\u0022,\u0022search.ui.input.label\u0022:\u0022Search\u0022,\u0022search.ui.input.aria.label\u0022:\u0022Search, when you type, your results will be displayed below.\u0022,\u0022search.ui.search.result\u0022:\u0022{0,choice,1#{0} search result|1\u003c{0} search results}\u0022,\u0022search.ui.filter.label.button.text\u0022:\u0022Label\u0022,\u0022search.ui.container.clear.ariaLabel\u0022:\u0022Clear\u0022,\u0022search.ui.input.alert\u0022:\u0022Hit enter to search\u0022,\u0022search.ui.filter.no.result.text\u0022:\u0022We can\u0027\u0027t find anything matching your search\u0022,\u0022search.ui.result.subtitle.user\u0022:\u0022User profile\u0022,\u0022search.ui.filter.contributor.input.label\u0022:\u0022Find people...\u0022,\u0022search.ui.filter.content.type.button.text\u0022:\u0022Type\u0022,\u0022search.ui.filter.date.year.text\u0022:\u0022The past year\u0022,\u0022search.ui.advanced.search.link.text\u0022:\u0022Advanced search\u0022,\u0022search.ui.filter.space.button.text\u0022:\u0022Space\u0022,\u0022search.ui.search.results.clear.line2\u0022:\u0022Try a different search term or\u0022,\u0022search.ui.filter.space.category.button.text\u0022:\u0022Space category\u0022,\u0022search.ui.search.results.clear.line1\u0022:\u0022We couldn\u0027\u0027t find anything matching your search.\u0022,\u0022search.ui.content.name.search.items.panel.load.all.top.items.admin.button.text\u0022:\u0022Show more settings and app results...\u0022,\u0022search.ui.recent.pages\u0022:\u0022Recently visited\u0022,\u0022search.ui.search.result.anonymous\u0022:\u0022{0,choice,1#{0} search result|1\u003c{0} search results}. Have an account? {1}Log in{2} to expand your search.\u0022,\u0022search.ui.recent.items.empty\u0022:\u0022Start exploring. Pages and spaces you\u0027\u0027ve visited recently will appear here.\u0022,\u0022search.ui.filter.space.init.heading\u0022:\u0022recent spaces\u0022}";
WRM._unparsedData["com.atlassian.applinks.applinks-plugin:applinks-common-exported.applinks-types"]="{\u0022crowd\u0022:\u0022Crowd\u0022,\u0022confluence\u0022:\u0022Confluence\u0022,\u0022fecru\u0022:\u0022FishEye / Crucible\u0022,\u0022stash\u0022:\u0022Stash\u0022,\u0022jira\u0022:\u0022Jira\u0022,\u0022refapp\u0022:\u0022Reference Application\u0022,\u0022bamboo\u0022:\u0022Bamboo\u0022,\u0022generic\u0022:\u0022Generic Application\u0022}";
WRM._unparsedData["com.atlassian.confluence.plugins.synchrony-interop:synchrony-status-banner-loader.synchrony-status"]="false";
WRM._unparsedData["com.atlassian.applinks.applinks-plugin:applinks-common-exported.applinks-help-paths"]="{\u0022entries\u0022:{\u0022applinks.docs.root\u0022:\u0022https://confluence.atlassian.com/display/APPLINKS-090/\u0022,\u0022applinks.docs.diagnostics.troubleshoot.sslunmatched\u0022:\u0022SSL+and+application+link+troubleshooting+guide\u0022,\u0022applinks.docs.diagnostics.troubleshoot.oauthsignatureinvalid\u0022:\u0022OAuth+troubleshooting+guide\u0022,\u0022applinks.docs.diagnostics.troubleshoot.oauthtimestamprefused\u0022:\u0022OAuth+troubleshooting+guide\u0022,\u0022applinks.docs.delete.entity.link\u0022:\u0022Create+links+between+projects\u0022,\u0022applinks.docs.adding.application.link\u0022:\u0022Link+Atlassian+applications+to+work+together\u0022,\u0022applinks.docs.administration.guide\u0022:\u0022Application+Links+Documentation\u0022,\u0022applinks.docs.oauth.security\u0022:\u0022OAuth+security+for+application+links\u0022,\u0022applinks.docs.troubleshoot.application.links\u0022:\u0022Troubleshoot+application+links\u0022,\u0022applinks.docs.diagnostics.troubleshoot.unknownerror\u0022:\u0022Network+and+connectivity+troubleshooting+guide\u0022,\u0022applinks.docs.configuring.auth.trusted.apps\u0022:\u0022Configuring+Trusted+Applications+authentication+for+an+application+link\u0022,\u0022applinks.docs.diagnostics.troubleshoot.authlevelunsupported\u0022:\u0022OAuth+troubleshooting+guide\u0022,\u0022applinks.docs.diagnostics.troubleshoot.ssluntrusted\u0022:\u0022SSL+and+application+link+troubleshooting+guide\u0022,\u0022applinks.docs.diagnostics.troubleshoot.unknownhost\u0022:\u0022Network+and+connectivity+troubleshooting+guide\u0022,\u0022applinks.docs.delete.application.link\u0022:\u0022Link+Atlassian+applications+to+work+together\u0022,\u0022applinks.docs.adding.project.link\u0022:\u0022Configuring+Project+links+across+Applications\u0022,\u0022applinks.docs.link.applications\u0022:\u0022Link+Atlassian+applications+to+work+together\u0022,\u0022applinks.docs.diagnostics.troubleshoot.oauthproblem\u0022:\u0022OAuth+troubleshooting+guide\u0022,\u0022applinks.docs.diagnostics.troubleshoot.migration\u0022:\u0022Update+application+links+to+use+OAuth\u0022,\u0022applinks.docs.relocate.application.link\u0022:\u0022Link+Atlassian+applications+to+work+together\u0022,\u0022applinks.docs.administering.entity.links\u0022:\u0022Create+links+between+projects\u0022,\u0022applinks.docs.upgrade.application.link\u0022:\u0022OAuth+security+for+application+links\u0022,\u0022applinks.docs.diagnostics.troubleshoot.connectionrefused\u0022:\u0022Network+and+connectivity+troubleshooting+guide\u0022,\u0022applinks.docs.configuring.auth.oauth\u0022:\u0022OAuth+security+for+application+links\u0022,\u0022applinks.docs.insufficient.remote.permission\u0022:\u0022OAuth+security+for+application+links\u0022,\u0022applinks.docs.configuring.application.link.auth\u0022:\u0022OAuth+security+for+application+links\u0022,\u0022applinks.docs.diagnostics\u0022:\u0022Application+links+diagnostics\u0022,\u0022applinks.docs.configured.authentication.types\u0022:\u0022OAuth+security+for+application+links\u0022,\u0022applinks.docs.adding.entity.link\u0022:\u0022Create+links+between+projects\u0022,\u0022applinks.docs.diagnostics.troubleshoot.unexpectedresponse\u0022:\u0022Network+and+connectivity+troubleshooting+guide\u0022,\u0022applinks.docs.configuring.auth.basic\u0022:\u0022Configuring+Basic+HTTP+Authentication+for+an+Application+Link\u0022,\u0022applinks.docs.diagnostics.troubleshoot.authlevelmismatch\u0022:\u0022OAuth+troubleshooting+guide\u0022}}";
WRM._unparsedData["com.atlassian.confluence.plugins.confluence-feature-discovery-plugin:confluence-feature-discovery-plugin-resources.test-mode"]="false";
if(window.WRM._dataArrived)window.WRM._dataArrived();</script>
<link rel="stylesheet" href="/s/3906b0a9678c0e7366e2037031ee723f-CDN/-5iwf5w/9004/9r8qvy/88fd744a9e5c04fb75da4bef47308e85/_/download/contextbatch/css/_super,-com.atlassian.plugins.atlassian-plugins-webresource-rest:data-collector-perf-observer/batch.css" data-wrm-key="_super,-com.atlassian.plugins.atlassian-plugins-webresource-rest:data-collector-perf-observer" data-wrm-batch-type="context" media="all">
<link rel="stylesheet" href="/s/0c56633e0aefa2b6661634c23890e5e1-CDN/-5iwf5w/9004/9r8qvy/874b773bd8d8c495dc5a9025eccfabcc/_/download/contextbatch/css/atl.confluence.plugins.pagetree-desktop,main,viewcontent,atl.general,page,atl.comments,-_super/batch.css?cefp_collab_enabled=true&amp;cefp_ed_perm=false&amp;cefp_is_admin=false&amp;gatekeeper-ui-v2=true&amp;highlightactions=true" data-wrm-key="atl.confluence.plugins.pagetree-desktop,main,viewcontent,atl.general,page,atl.comments,-_super" data-wrm-batch-type="context" media="all">
<link rel="stylesheet" href="/s/-5iwf5w/9004/9r8qvy/8/_/styles/custom.css" media="all">
<script data-wrm-key="com.atlassian.plugins.atlassian-plugins-webresource-rest:data-collector-perf-observer" data-wrm-batch-type="resource" data-initially-rendered>
!function(){"use strict";if("PerformanceObserver"in window){const e=[];window.__observedResources=e;const r=e=>"script"===e?"script":"css";new PerformanceObserver((n=>{n.getEntries().filter((({initiatorType:e,name:r})=>{const n="script"===e||((e,r)=>"link"===e&&"css"===new URL(r).pathname.split(".").pop())(e,r),i=new URL(location.href).origin===new URL(r).origin;return n&&i})).forEach((({name:n,transferSize:i,encodedBodySize:s,initiatorType:o})=>{e.push([i,s,n,r(o)])}))})).observe({type:"resource"})}}();

</script>
<script src="/s/db7b93668ec3f1e28b20d5f4cb5aaf12-CDN/-5iwf5w/9004/9r8qvy/88fd744a9e5c04fb75da4bef47308e85/_/download/contextbatch/js/_super,-com.atlassian.plugins.atlassian-plugins-webresource-rest:data-collector-perf-observer/batch.js?locale=en-GB" data-wrm-key="_super,-com.atlassian.plugins.atlassian-plugins-webresource-rest:data-collector-perf-observer" data-wrm-batch-type="context" data-initially-rendered></script>
<script src="/s/0341ac3c08eb7d3372fdf748f56002e3-CDN/-5iwf5w/9004/9r8qvy/874b773bd8d8c495dc5a9025eccfabcc/_/download/contextbatch/js/atl.confluence.plugins.pagetree-desktop,main,viewcontent,atl.general,page,atl.comments,-_super/batch.js?cefp_collab_enabled=true&amp;cefp_ed_perm=false&amp;cefp_is_admin=false&amp;gatekeeper-ui-v2=true&amp;highlightactions=true&amp;locale=en-GB" data-wrm-key="atl.confluence.plugins.pagetree-desktop,main,viewcontent,atl.general,page,atl.comments,-_super" data-wrm-batch-type="context" data-initially-rendered></script>
<script type="module">WRM.requireLazily(["wr!com.atlassian.plugins.atlassian-plugins-webresource-rest:data-collector-async"])</script>
    

        
    

        
        <meta name="ajs-site-title" content="Confluence" />
            
    <script>
jQuery(document).ready(function() {
    jQuery(".external-link").attr("target", "_blank");
});
</script>
<script type="text/javascript">
    AJS.toInit(function(){
        if (AJS.params.remoteUser == ''){
          AJS.$('#who-can-view-button-ak-button').hide();
         
        }
    });
</script>

    
                <link rel="canonical" href="https://unlimited.ethz.ch/display/openBISDoc2010/Installation+and+Administrators+Guide+of+the+openBIS+Data+Store+Server">
        <link rel="shortlink" href="https://unlimited.ethz.ch/x/Sxk0Aw">
    <meta name="wikilink" content="[openBISDoc2010:Installation and Administrators Guide of the openBIS Data Store Server]">
    <meta name="page-version" content="7">
    <meta name="ajs-page-version" content="7">

</head>

    
<body      id="com-atlassian-confluence" class="theme-default  aui-layout aui-theme-default">

        
            <div id='stp-licenseStatus-banner'></div>
            <meta name="ajs-is-scroll-viewport-available" content="true">
    <div id="page">
<div id="full-height-container">
    <div id="header-precursor">
        <div class="cell">
            
                            </div>
    </div>
        





<header id="header" role="banner">
            <a class="aui-skip-link" href="https://unlimited.ethz.ch/login.action?os_destination=%2Fdisplay%2FopenBISDoc2010%2FInstallation%2Band%2BAdministrators%2BGuide%2Bof%2Bthe%2BopenBIS%2BData%2BStore%2BServer" tabindex="1">Log in</a>
        <nav class="aui-header aui-dropdown2-trigger-group" aria-label="Site"><div class="aui-header-inner"><div class="aui-header-before"><button class=" aui-dropdown2-trigger app-switcher-trigger aui-dropdown2-trigger-arrowless" aria-controls="app-switcher" aria-haspopup="true" role="button" data-aui-trigger href="#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></button><div id="app-switcher" class="aui-dropdown2 aui-style-default" role="menu" hidden data-is-user-admin="false" data-is-switcher="true"><div class="app-switcher-loading">Loading&hellip;</div></div></div><div class="aui-header-primary"><span id="logo" class="aui-header-logo aui-header-logo-custom"><a href="/" aria-label="Go to home page"><img src="/download/attachments/327682/atl.site.logo?version=1&amp;modificationDate=1563454119905&amp;api=v2" alt="Confluence" /></a></span><ul class="aui-nav">
                            <li>
            
    
        
<a  id="space-directory-link" href="/spacedirectory/view.action"  class=" aui-nav-imagelink"   title="Spaces">
            <span>Spaces</span>
    </a>
        </li>
                                <li class="aui-buttons">
                                <a href="#" id="create-page-button" class="aui-button aui-button-primary clc-create-dialog-btn" title = 'Create from template' tabindex="0"><span class="aui-icon aui-icon-small aui-iconfont-more">Create </span></a>
            </li>
</ul>
</div><div class="aui-header-secondary"><ul class="aui-nav">
                        <li>
        <div id="search-ui" class="aui-quicksearch dont-default-focus header-quicksearch"><button id="quick-search-query-button" aria-label="Search" aria-haspopup= "dialog" aria-controls="search_drawer" ></button><input id="quick-search-query" aria-label="Search" placeholder="Search" type="text" aria-haspopup= "dialog" aria-controls="search_drawer" /><div id="quick-search-alert" role="alert">Hit enter to search</div><aui-spinner size="small"></aui-spinner></div>
    </li>
        <li>
            
        <a id="help-menu-link" role="button" class="aui-nav-link aui-dropdown2-trigger aui-dropdown2-trigger-arrowless" href="#" aria-haspopup="true" aria-owns="help-menu-link-content" title="Help">
        <span class="aui-icon aui-icon-small aui-iconfont-question-filled">Help</span>
    </a>
    <nav id="help-menu-link-content" class="aui-dropdown2 aui-style-default" >
                    <div class="aui-dropdown2-section">
                                    <strong></strong>
                                <ul role="menu"
                     role="menu"                    aria-label="Help"                    id="help-menu-link-pages"                    class="aui-list-truncate section-pages first">
                                            <li role="presentation">
        
            
<a role="menuitem"  id="confluence-help-link" href="https://docs.atlassian.com/confluence/docs-82/" class="    "      title="Visit the Confluence documentation home"  target="_blank"
>
        Online Help
</a>
</li>
                                            <li role="presentation">
    
                
<a role="menuitem"  id="keyboard-shortcuts-link" href="#" class="    "      title="View available keyboard shortcuts" >
        Keyboard Shortcuts
</a>
</li>
                                            <li role="presentation">
    
            
<a role="menuitem"  id="feed-builder-link" href="/dashboard/configurerssfeed.action" class="    "      title="Create your custom RSS feed." >
        Feed Builder
</a>
</li>
                                            <li role="presentation">
    
            
<a role="menuitem"  id="whats-new-menu-link" href="https://confluence.atlassian.com/display/DOC/Confluence+8.2+Release+Notes" class="    "      title="" >
        What’s new
</a>
</li>
                                            <li role="presentation">
    
                
<a role="menuitem"  id="gadget-directory-link" href="#" class="   user-item administration-link "      title="Browse gadgets provided by Confluence" >
        Available Gadgets
</a>
</li>
                                            <li role="presentation">
    
            
<a role="menuitem"  id="confluence-about-link" href="/aboutconfluencepage.action" class="    "      title="Get more information about Confluence" >
        About Confluence
</a>
</li>
                                    </ul>
            </div>
            </nav>
    
    </li>
        <li>
                
    
    </li>
        <li>
            
    </li>
        <li>
                                            <li>
        
            
<a role="menuitem"  id="login-link" href="/login.action?os_destination=%2Fdisplay%2FopenBISDoc2010%2FInstallation%2Band%2BAdministrators%2BGuide%2Bof%2Bthe%2BopenBIS%2BData%2BStore%2BServer" class="   user-item login-link "      title="" >
        Log in
</a>
</li>
                        
    </li>
    </ul>
</div></div><!-- .aui-header-inner--></nav><!-- .aui-header -->
    <br class="clear">
</header>
    

    
    	<div class="ia-splitter">
    		<div class="ia-splitter-left">
    			<div class="ia-fixed-sidebar" role="complementary" aria-label=sidebar>
                                            
                            <div class="acs-side-bar ia-scrollable-section"><div class="acs-side-bar-space-info tipsy-enabled" data-configure-tooltip="Edit space details"><div class="avatar"><div class="space-logo" data-key="openBISDoc2010" data-name="openBIS Documentation Rel. 20.10" data-entity-type="confluence.space"><div class="avatar-img-container"><div class="avatar-img-wrapper"><a href="/display/openBISDoc2010/openBIS+Documentation+Rel.+20.10+Home" title="openBIS Documentation Rel. 20.10"><img class="avatar-img" src="/images/logo/default-space-logo.svg" alt="openBIS Documentation Rel. 20.10"></a></div></div></div></div><div class="space-information-container"><div class="name"><a href="/display/openBISDoc2010/openBIS+Documentation+Rel.+20.10+Home" title="openBIS Documentation Rel. 20.10">openBIS Documentation Rel. 20.10</a></div><div class="flyout-handle icon aui-icon aui-icon-small aui-iconfont-edit"></div></div></div><div class="acs-side-bar-content"><div class="acs-nav-wrapper"><div class="acs-nav" data-has-create-permission="false" data-quick-links-state="null" data-page-tree-state="null" data-nav-type="page-tree"><div class="acs-nav-sections"><div class="main-links-section "><ul class="acs-nav-list"><li class="acs-nav-item wiki current-item" aria-current="true" data-collector-key="spacebar-pages"><a class="acs-nav-item-link tipsy-enabled" href="/collector/pages.action?key=openBISDoc2010" data-collapsed-tooltip="Pages"><span class="icon"></span><span class="acs-nav-item-label">Pages</span></a></li><li class="acs-nav-item blog" data-collector-key="spacebar-blogs"><a class="acs-nav-item-link tipsy-enabled" href="/pages/viewrecentblogposts.action?key=openBISDoc2010" data-collapsed-tooltip="Blog"><span class="icon"></span><span class="acs-nav-item-label">Blog</span></a></li></ul></div><div class="quick-links-wrapper"></div></div></div></div><div class="ia-secondary-container tipsy-enabled" data-tree-type="page-tree"><div class="ia-secondary-header"><h2 class="ia-secondary-header-title page-tree"><span class="icon"></span><span class="label">Page tree</span></h2></div><div class="ia-secondary-content">


<div class="plugin_pagetree conf-macro output-inline" data-hasbody="false" data-macro-name="pagetree">

        
        
    <ul role="list" class="plugin_pagetree_children_list plugin_pagetree_children_list_noleftspace">
        <div class="plugin_pagetree_children">
        </div>
    </ul>

    <fieldset class="hidden">
        <input type="hidden" name="treeId" value="" />
        <input type="hidden" name="treeRequestId" value="/plugins/pagetree/naturalchildren.action?decorator=none&amp;excerpt=false&amp;sort=position&amp;reverse=false&amp;disableLinks=false&amp;expandCurrent=true&amp;placement=sidebar" />
        <input type="hidden" name="treePageId" value="53745995" />

        <input type="hidden" name="noRoot" value="false" />
        <input type="hidden" name="rootPageId" value="53746067" />

        <input type="hidden" name="rootPage" value="" />
        <input type="hidden" name="startDepth" value="0" />
        <input type="hidden" name="spaceKey" value="openBISDoc2010" />

        <input type="hidden" name="i18n-pagetree.loading" value="Loading..." />
        <input type="hidden" name="i18n-pagetree.error.permission" value="Unable to load page tree. It seems that you do not have permission to view the root page." />
        <input type="hidden" name="i18n-pagetree.eeror.general" value="There was a problem retrieving the page tree. Please check the server log file for more information." />
        <input type="hidden" name="loginUrl" value="/login.action?os_destination=%2Fpages%2Fviewpage.action%3FspaceKey%3DopenBISDoc2010%26title%3DInstallation%2Band%2BAdministrators%2BGuide%2Bof%2Bthe%2BopenBIS%2BData%2BStore%2BServer&amp;permissionViolation=true" />
        <input type="hidden" name="mobile" value="false" />
        <input type="hidden" name="placement" value="sidebar" />

                <fieldset class="hidden">
                                                <input type="hidden" name="ancestorId" value="53746006" />
                                    <input type="hidden" name="ancestorId" value="53746072" />
                                    <input type="hidden" name="ancestorId" value="53746067" />
                                    </fieldset>
    </fieldset>
</div>
</div></div></div><div class="hidden"><a href="/collector/pages.action?key=openBISDoc2010" id="space-pages-link"></a><script type="text/x-template" title="logo-config-content"><h2>Space Details</h2><div class="personal-space-logo-hint">Your profile picture is used as the logo for your personal space. <a href="/users/profile/editmyprofilepicture.action" target="_blank">Change your profile picture</a>.</div></script></div></div><div class="space-tools-section"><div id="space-tools-menu-additional-items" class="hidden"><div data-label="Browse pages" data-class="" data-href="/pages/reorderpages.action?key=openBISDoc2010">Browse pages</div></div><button id="space-tools-menu-trigger"  class=" aui-dropdown2-trigger aui-button aui-button-subtle tipsy-enabled aui-dropdown2-trigger-arrowless " aria-controls="space-tools-menu" aria-haspopup="true" role="button" data-aui-trigger><span class="aui-icon aui-icon-small aui-iconfont-configure">Configure</span><span class="aui-button-label">Space tools</span><span class="aui-icon "></span></button><div id="space-tools-menu" class="aui-dropdown2 aui-style-default space-tools-dropdown" role="menu" hidden data-aui-alignment="top left"></div><a href="#" role="button" class="expand-collapse-trigger aui-icon aui-icon-small aui-iconfont-chevron-double-left" aria-expanded="true"></a></div>
                    
                        			</div>
    		</div>
        <!-- \#header -->

            
    
        <main role="main" id="main" class=" aui-page-panel">
                        <div id="main-header">
                        
    <div id="navigation" class="content-navigation view" role="region" aria-label="Page tools">
                    <ul class="ajs-menu-bar">
                                            
        <li class="normal ajs-menu-item">
        <a id="action-menu-link" class="action aui-dropdown2-trigger-arrowless aui-button aui-button-subtle ajs-menu-title aui-dropdown2-trigger" href="#" aria-haspopup="true" aria-label="More options" aria-owns="action-menu" data-container="#navigation">
            <span>
                                    <span class="aui-icon aui-icon-small aui-iconfont-more" aria-label="More options"></span>
                                
            </span>
        </a>         <div id="action-menu" class="aui-dropdown2 aui-style-default"  role="menu" aria-labelledby="action-menu-link" >
                            <div class="aui-dropdown2-section">
                    <ul  id="action-menu-primary"                          class="section-primary first"                         role="presentation" >
                                                    <li
                    role="presentation"
            >

    
        
    
                                                                        
    
    
            <a  id="view-attachments-link"                href="/pages/viewpageattachments.action?pageId=53745995"
                rel="nofollow"
                class="action-view-attachments"
                 accessKey="t"                 title="View Attachments"                                                 role="menuitem"                >

                        <span>
                                A<u>t</u>tachments (10)
            </span>        </a>
    </li>
                                                <li
                    role="presentation"
            >

    
        
    
                                                                        
    
    
            <a  id="action-view-history-link"                href="/pages/viewpreviousversions.action?pageId=53745995"
                rel="nofollow"
                class="action-view-history"
                                 title=""                                                 role="menuitem"                >

                        <span>
                                Page History
            </span>        </a>
    </li>
                                        </ul>
                </div>
                            <div class="aui-dropdown2-section">
                    <ul  id="action-menu-secondary"                          class="section-secondary"                         role="presentation" >
                                                    <li
                    role="presentation"
            >

    
        
    
                                                                        
    
    
            <a  id="view-page-info-link"                href="/pages/viewinfo.action?pageId=53745995"
                rel="nofollow"
                class="action-view-info"
                                 title=""                                                 role="menuitem"                >

                        <span>
                                Page Information
            </span>        </a>
    </li>
                                                <li
                    role="presentation"
            >

    
            
    
                                                                        
    
    
            <a  id="view-resolved-comments"                href="#"
                rel="nofollow"
                class=""
                                 title=""                                                 role="menuitem"                >

                        <span>
                                Resolved comments
            </span>        </a>
    </li>
                                                <li
                    role="presentation"
            >

    
        
    
                                                                        
    
    
            <a  id="view-in-hierarchy-link"                href="/pages/reorderpages.action?key=openBISDoc2010&amp;openId=53745995#selectedPageInHierarchy"
                rel="nofollow"
                class=""
                                 title=""                                                 role="menuitem"                >

                        <span>
                                View in Hierarchy
            </span>        </a>
    </li>
                                                <li
                    role="presentation"
            >

    
        
    
                                                                        
    
    
            <a  id="action-view-source-link"                href="/plugins/viewsource/viewpagesrc.action?pageId=53745995"
                rel="nofollow"
                class="action-view-source popup-link"
                                 title=""                                                 role="menuitem"                >

                        <span>
                                View Source
            </span>        </a>
    </li>
                                                <li
                    role="presentation"
            >

    
        
    
                                                                        
    
    
            <a  id="action-export-pdf-link"                href="/spaces/flyingpdf/pdfpageexport.action?pageId=53745995"
                rel="nofollow"
                class=""
                                 title=""                                                 role="menuitem"                >

                        <span>
                                Export to PDF
            </span>        </a>
    </li>
                                                <li
                    role="presentation"
            >

    
        
    
                                                                        
    
    
            <a  id="action-export-word-link"                href="/exportword?pageId=53745995"
                rel="nofollow"
                class="action-export-word"
                                 title=""                                                 role="menuitem"                >

                        <span>
                                Export to Word
            </span>        </a>
    </li>
                                                <li
                    role="presentation"
            >

    
        
    
                                                                        
    
    
            <a                 href="/plugins/lucidchart/selectVisio.action?contentId=53745995"
                rel="nofollow"
                class=""
                                 title=""                                                 role="menuitem"                >

                        <span>
                                View Visio File
            </span>        </a>
    </li>
                                        </ul>
                </div>
                            <div class="aui-dropdown2-section">
                    <ul  id="action-menu-modify"                          class="section-modify"                         role="presentation" >
                                                    <li
                    role="presentation"
            >

    
        
    
                                                                        
    
    
            <a  id="action-copy-page-link"                href="/pages/copypage.action?idOfPageToCopy=53745995&amp;spaceKey=openBISDoc2010"
                rel="nofollow"
                class="action-copy"
                                 title=""                                                 role="menuitem"                >

                        <span>
                                Copy
            </span>        </a>
    </li>
                                        </ul>
                </div>
                    </div>
    </li>
            </ul>
    </div>

            
            <div id="title-heading" class="pagetitle with-breadcrumbs">
                
                                    <div id="breadcrumb-section">
                        
    
    
    <nav aria-label="Breadcrumbs">
        <ol id="breadcrumbs">
                                                            
                                
            <li class="first" >
                                
                                    <span class=""><a href="/collector/pages.action?key=openBISDoc2010">Pages</a></span>
                                                                                                                                                <li id="ellipsis" title="Show all breadcrumbs"><button class="elipsis-button" aria-label="Show all breadcrumbs"><strong>&#8230;</strong></button></li>
                                                            
                                
            <li class="hidden-crumb" >
                                
                                    <span class=""><a href="/display/openBISDoc2010/openBIS+Documentation+Rel.+20.10+Home">openBIS Documentation Rel. 20.10 Home</a></span>
                                                                                                                                        
                                
            <li class="hidden-crumb" >
                                
                                    <span class=""><a href="/display/openBISDoc2010/openBIS+20.10+Documentation">openBIS 20.10 Documentation</a></span>
                                                                                                                    
                                
            <li>
                                
                                    <span class=""><a href="/display/openBISDoc2010/Guides">Guides</a></span>
                                                                                                    </ol>
    </nav>


                    </div>
                
                
                
            <div id="page-metadata-banner"><ul class="banner"><li id="system-content-items" class="noprint"><a href="" title="Unrestricted" id="content-metadata-page-restrictions-hidden" class="hidden"></a><a href="/pages/viewpageattachments.action?pageId=53745995&amp;metadataLink=true" title="10 attachments" id="content-metadata-attachments" class="aui-icon aui-icon-small aui-iconfont-attachment"></a></li><li class="page-metadata-item noprinthas-button"  id="content-metadata-jira-wrapper"><a href="" title="" id="content-metadata-jira" class="aui-button aui-button-subtle content-metadata-jira tipsy-disabled hidden"><span>Jira links</span></a></li></ul></div>
        

                <h1 id="title-text" class="with-breadcrumbs">
                                                <a href="/display/openBISDoc2010/Installation+and+Administrators+Guide+of+the+openBIS+Data+Store+Server">Installation and Administrators Guide of the openBIS Data Store Server</a>
                                    </h1>
            </div>
        </div><!-- \#main-header -->
        
        

        <div id="sidebar-container">
                                                </div><!-- \#sidebar-container -->

        
    

        




            
    

                                
    

    
    
        
    
    
                    
    

    

    
            
        

    
    

    
            
        



    
<div id="content" class="page view">
    


<div id="action-messages">
                        </div>



            <script type="text/x-template" title="searchResultsGrid">
    <table class="aui">
        <thead>
            <tr class="header">
                <th class="search-result-title">Page Title</th>
                <th class="search-result-space">Space</th>
                <th class="search-result-date">Updated</th>
            </tr>
        </thead>
    </table>
</script>
<script type="text/x-template" title="searchResultsGridCount">
    <p class="search-result-count">{0}</p>
</script>
<script type="text/x-template" title="searchResultsGridRow">
    <tr class="search-result">
        <td class="search-result-title"><a href="{1}" class="content-type-{2}"><span>{0}</span></a></td>
        <td class="search-result-space"><a class="space" href="/display/{4}/" title="{3}">{3}</a></td>
        <td class="search-result-date"><span class="date" title="{6}">{5}</span></td>
    </tr>
</script>
        
    
            

        
                            
    

                    

        
        <div class="page-metadata">
    <ul>
        <li class="page-metadata-modification-info">
            
        
    
    
        
    
        
            
            Created by <span class='author'>     <a href="    /display/~juanf
"
            aria-label="created by Fuentes Serna  Juan Mariano (ID)"                       class="url fn"
                            >Fuentes Serna  Juan Mariano (ID)</a></span>, last modified on <a class='last-modified' aria-label='modified on Apr 26, 2023, select to show changes' title='Show changes' href='/pages/diffpagesbyversion.action?pageId=53745995&amp;selectedPageVersions=6&amp;selectedPageVersions=7'>Apr 26, 2023</a>
            </li>
    </ul>
</div>
        
                                            
        <div id="main-content" class="wiki-content">
                           
        <p><div class="toc-macro client-side-toc-macro  conf-macro output-block" data-hasbody="false" data-headerelements="H1,H2,H3,H4,H5,H6,H7" data-macro-name="toc"> </div></p><p>For the System Requirements, see  <a href="/display/openBISDoc2010/Installation+and+Administrator+Guide+of+the+openBIS+Server">Installation and Administrator Guide of the openBIS Server</a>. The openBIS Application server needs to be running when installing the openBIS Data Store Server (DSS).</p><h2 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Installation">Installation</h2><p>For installing DSS the main distribution (naming schema: <code>datastore_server-&lt;version&gt;</code> <code> <span style="text-decoration: line-through;">r&lt;revision&gt;.zip</span> </code>) and optional plugin distributions (naming schema:<code>datastore_server_plugin</code> <code>&lt;plugin name&gt;&lt;version&gt;-r&lt;revision&gt;.zip</code>) are needed. The main distribution contains:</p><ul><li><code>datastore_server/datastore_server.sh</code>: Bash script for starting/stopping the server.</li><li><code>datastore_server/lib</code>: Folder with libraries needed.</li><li><code>datastore_server/etc</code>: Folder with configuration files and key stores.</li><li><code>datastore_server/data</code>: Example data folder configured to run the demo.</li><li><code>datastore_server/log</code>: Empty folder which will contain log files.</li></ul><p>The plugin distribution contain stuff relative to the DSS main folder <code>&lt;some folder&gt;/datastore_server</code>.</p><h3 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Installationsteps">Installation steps</h3><ol><li>Create a service user account, i.e. an unprivileged, regular user account. You can use the same user account for running the Application Server and the Data Store Server. <strong>Do not run openBIS DSS as root!</strong></li><li>Unzip the main distribution on the server machine on its final location.</li><li>If plugins are required go into the folder <code>datastore_server</code> and unzip them there.</li><li>Adapt <code>datastore_server/etc/service.properties</code>.</li><li>Create a Role in openBIS for the etlserver user: Administration -&gt; Authorization -&gt; Roles -&gt; Assign Role<br/>Choose as a role 'INSTANCE_ETL_SERVER' and select as a person 'etlserver'<br/>If you do not do this and start up the Datastore Server you will get an error in the <code>log/datastore_server_log.txt</code> saying<br/><code>Authorization failure: No role assignments could be found for user 'etlserver'.</code></li><li><p>Start up the server as follows:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>prompt&gt; ./datastore_server.sh start
</pre>
</div></div><p>Have look into the log files: They should be free of exception stack traces.</p></li></ol><h2 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Configurationfile">Configuration file</h2><p>The configuration file <code>datastore_server/etc/service.properties</code> is an <a href="/display/openBISDoc2010/Extended+Configuration+Properties">Extended Properties File</a>. It can have a lot of properties. Most defining plugins which can be extracted as a plugin configuration into the core plugins. For more see <a href="/display/openBISDoc2010/Core+Plugins">Core Plugins</a>. Nevertheless, here is a typical example which still contains everything:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedHeader panelHeader" style="border-bottom-width: 1px;"><b>service.properties</b></div><div class="preformattedContent panelContent">
<pre># Unique code of this Data Store Server. Not more than 40 characters.
data-store-server-code = DSS1

# The root directory of the data store
storeroot-dir = data/store

# The directory where the command queue files are located; defaults to storeroot-dir 
commandqueue-dir =

# Comma-separated list of definitions of additional queues for processing processing plugins.
# Each entry is of the form &lt;queue name&gt;:&lt;regular expression&gt;
# A corresponding persistent queue is created. All processing plugins with a key matching the corresponding
# regular expression are associated with the corresponding queue.
#
# The key of a processing plugin is its core-plugin name which is the name of the folder containing 
# 'plugin.properties'. 
#
# In case of archiving is enabled the following three processing plugins are defined:
# 'Archiving', 'Copying data sets to archive', and 'Unarchiving'
#data-set-command-queue-mapping = archiving:Archiving|Copying data sets to archive

# Cache for data set files from other Data Store Servers
# cache-workspace-folder = ../../data/dss-cache
# Maximum cache size in MB
# cache-workspace-max-size = 1024
# cache-workspace-min-keeping-time = 

# Port
port = 8444

# Session timeout in minutes
session-timeout = 720

# Path to the keystore
keystore.path = etc/openBIS.keystore

# Password of the keystore
keystore.password = changeit

# Key password of the keystore
keystore.key-password = changeit

# The check interval (in seconds)
check-interval = 60

# The time-out for clean up work in the shutdown sequence (in seconds).
# Note that that the maximal time for the shutdown sequence to complete can be as large
# as twice this time.
# Remark: On a network file system, it is not recommended to turn this value to something
# lower than 180.
shutdown-timeout = 180

===============================
# Data Set Registration Halt:
#
# In order to prevent the data store from having no free disk space a limit (so called highwater mark) can be
# specified. If the free disk space of the associated share goes below this specified value, 
# DSS halts to register data sets. Also a notification log and an email will be produced. 
# When the free disk space is again above the limit registration will be continued.

# The value must be specified in kilobytes (1048576 = 1024 * 1024 = 1GB). If no high water mark is
# specified or if the value is negative, the system will not be watching. There are 2 different kinds
# of highwater mark supported: the one 'highwater-mark' that is checking the space on the store, and 
# one 'recovery-highwater-mark' that is checking the amount of free space for recovery state (on the local filesystem).
# 
# Core plugins of type drop box and ingestion services (special type of reporting-plugins) can override the
# highwater mark value individually by specifying the property 'incoming-share-minimum-free-space-in-gb' 
# in their plugin.properties. 
highwater-mark = -1
recovery-highwater-mark = -1


# If a data set is successfully registered it sends out an email to the registrator.
# If this property is not specified, no email is sent to the registrator. This property
# does not affect the mails which are sent, when the data set could not be registered.
notify-successful-registration = false

# The URL of the openBIS server
server-url = https://localhost:8443/openbis/openbis

# The username to use when contacting the openBIS server
username = etlserver

# The password to use when contacting the openBIS server
password = etlserver

# The base URL for Web client access.
download-url = https://localhost:8889

# SMTP properties (must start with 'mail' to be considered).
# mail.smtp.host = localhost
# mail.from = datastore_server@localhost
# If this property is set a test e-mail will be sent to the specified address after DSS successfully started-up.
# mail.test.address = test@localhost

# ---------------- Timing parameters for file system operations on remote shares.

# Time (in seconds) to wait for any file system operation to finish. Operations exceeding this
# timeout will be terminated.
timeout = 60
# Number of times that a timed out operation will be tried again (0 means: every file system
# operation will only ever be performed once).
max-retries = 11
# Time (in seconds) to wait after an operation has been timed out before re-trying.
failure-interval = 10

# The period of no write access that needs to pass before an incoming data item is considered
# complete and ready to be processed (in seconds) [default: 300].
# Valid only when auto-detection method is used to determine if an incoming data are ready to be processed.
# quiet-period = &lt;value in seconds&gt;

# Globally used separator character which separates entities in a data set file name
data-set-file-name-entity-separator = _

# ---------------------------------------------------------------------------
# maintenance plugins configuration
# ---------------------------------------------------------------------------

# Comma separated names of maintenance plugins.
# Each plugin should have configuration properties prefixed with its name.
# Mandatory properties for each &lt;plugin&gt; include:
#   &lt;plugin&gt;.class - Fully qualified plugin class name
#   &lt;plugin&gt;.interval - The time between plugin executions (in seconds)
# Optional properties for each &lt;plugin&gt; include:
#   &lt;plugin&gt;.start - Time of the first execution (HH:mm)
#   &lt;plugin&gt;.execute-only-once - If true the task will be executed exactly once,
#                                interval will be ignored. By default set to false.
maintenance-plugins = demo-maintenance, auto-archiver, archive-cleanup, hierarchical-storage-updater

demo.class = ch.systemsx.cisd.etlserver.plugins.DemoMaintenancePlugin
demo.interval = 60
demo.start = 23:00

# ----- Automatic archiver configuration ------------------------------------
# Class of a task that performs automatic archivization of 'AVAILABLE' data sets based on their properties.
auto-archiver.class = ch.systemsx.cisd.etlserver.plugins.AutoArchiverTask
auto-archiver.interval = 10
auto-archiver.start = 23:00
# following properties are optional
# only data sets of specified type will be archived
auto-archiver.data-set-type = UNKNOWN
# only data sets that are older than specified number of days will be archived (default = 30)
auto-archiver.older-than = 90
# Indicates whether data sets will be removed from the data store upon archiving
# NOTE: You can configure two different auto-archiver tasks - one with 'remove-datasets-from-store'
# set to 'false'  to enable eager archiving and another one with the flag set to 'true' that will
# free space on the datastore server
auto-archiver.remove-datasets-from-store=false
# fully qualified class name of a policy that additionally filters data sets to be filtered
auto-archiver.policy.class = ch.systemsx.cisd.etlserver.plugins.DummyAutoArchiverPolicy

# use this policy to archive datasets in batches grouped by experiment and dataset type
# auto-archiver.policy.class = ch.systemsx.cisd.etlserver.plugins.ByExpermientPolicy
# use this policy to archive datasets in batches grouped by space
# auto-archiver.policy.class = ch.systemsx.cisd.etlserver.plugins.BySpacePolicy


# Default archival candidate discoverer, using &quot;older-than&quot; criteria
auto-archiver.archive-candidate-discoverer.class = ch.systemsx.cisd.etlserver.plugins.AgeArchiveCandidateDiscoverer
# use this archival dataset candidate discovery to auto-archive by tags. Please note that the &quot;older-than&quot; will take no effect with this one
# auto-archiver.archive-candidate-discoverer.class = ch.systemsx.cisd.etlserver.plugins.TagArchiveCandidateDiscoverer
# auto-archiver.archive-candidate-discoverer.tags = /admin/boo, /admin/foo


# ----- Alternative automatic archiver configuration ------------------------------------
# Performs automatic archiving of 'ACTIVE' data sets grouped by experiments based on the experiment's age
# (which is defined as last modification date of the youngest data set of the experiment).
# It iterates over all experiments, ordered by experiment age, and archives all non-locked, non-excluded
# data sets of an experiment. The estimated size of the archived data sets has to be configured via the
# 'estimated-data-set-size-in-KB.*' properties. The iteration over the experiments stops, when the estimated free
# disk space on the monitored directory is larger than 'minimum-free-space-in-MB'.
auto-archiver-exp.class = ch.systemsx.cisd.etlserver.plugins.ExperimentBasedArchivingTask
# The time between subsequent archivizations (in seconds)
auto-archiver-exp.interval = 86400
# Time of the first execution (HH:mm)
auto-archiver-exp.start = 23:15
# A directory to monitor for free disk space
#auto-archiver-exp.monitored-dir = /some/directory
# The mininum free space on the monitored share to ensure by archiving data sets (optional, default is 1024)
auto-archiver-exp.minimum-free-space-in-MB = 1024
# A coma-separated list of data set type keys to exclude from archiving (optional)
auto-archiver-exp.excluded-data-set-types = TYPE_KEY1, TYPE_KEY2
# Estimated data set size (in KB) for data set of type TYPE_KEY3
auto-archiver-exp.estimated-data-set-size-in-KB.TYPE_KEY3=300
# Default data set size estimation (in KB)
auto-archiver-exp.estimated-data-set-size-in-KB.DEFAULT=1200
# A free space provider class to be used
auto-archiver-exp.free-space-provider.class=ch.systemsx.cisd.openbis.dss.generic.shared.utils.PostgresPlusFileSystemFreeSpaceProvider
# PostgresSQL data source to be checked for free space
auto-archiver-exp.free-space-provider.monitored-data-source=data-source
# Whether a VACUUM command should be executed before the database is asked for the available free space
auto-archiver-exp.free-space-provider.execute-vacuum=true


# A task which cleans up deleted data sets from the archive
archive-cleanup.class = ch.systemsx.cisd.etlserver.plugins.DeleteFromArchiveMaintenanceTask
archive-cleanup.status-filename= ${root-dir}/deletion-event-lastseenid.txt
# keep the archive copies of the data set for one week after their deletion in openBIS
# the delay is specified in minutes
archive-cleanup.delay-after-user-deletion=604800
# start up time
archive-cleanup.start = 02:00
# run every day (in minutes)
archive-cleanup.interval = 86400

# the plugin which is run periodically to create a mirror structure of the store with the same files
# but with user-readable structure of directories
hierarchy-builder.class = ch.systemsx.cisd.etlserver.plugins.HierarchicalStorageUpdater
# The time between rebuilding the hierarchical store structure (in seconds)
hierarchy-builder.interval = 86400
# The root directory of the hierarchical data store
hierarchy-builder.hierarchy-root-dir = data/hierarchical-store
# The naming strategy for the symbolic links
hierarchy-builder.link-naming-strategy.class = ch.systemsx.cisd.etlserver.plugins.TemplateBasedLinkNamingStrategy
# The exact form of link names produced by TemplateBasedLinkNamingStrategy is configurable
# via the following template. The variables
#   dataSet, dataSetType, experiment, instance, project, sample, space
# will be recognized and replaced in the final link name.
hierarchy-builder.link-naming-strategy.template = ${space}/${project}/${experiment}/${dataSetType}+${sample}+${dataSet}
# When specified for a given &lt;dataset-type&gt; this store subpath will be used as the symbolic source
hierarchical-storage-updater.link-source-subpath.&lt;dataset-type&gt; = original
# Setting this property to &quot;true&quot; for a given &lt;dataset-type&gt; will treat the first child item (file or folder)
# in the specified location as the symbolic link source. It can be used in conjunction with
# the &quot;link-source-subpath.&lt;dataset-type&gt;&quot; to produce links pointing to a folder with unknown name e.g.
# &lt;data-set-location&gt;/original/UNKNOWN-NAME-20100307-1350
hierarchical-storage-updater.link-from-first-child.&lt;dataset-type&gt; = true


# ---------------------------------------------------------------------------
# (optional) archiver configuration
# ---------------------------------------------------------------------------

# Configuration of an archiver task. All properties are prefixed with 'archiver.'.

# Archiver class specification (together with the list of packages this class belongs to).
archiver.class = ch.systemsx.cisd.openbis.dss.generic.server.plugins.demo.DemoArchiver
# indicates if data should be synchronized when local copy is different than one in archive
archiver.synchronize-archive = false

# ---------------------------------------------------------------------------
# reporting and processing plugins configuration
# ---------------------------------------------------------------------------

# Comma separated names of reporting plugins. Each plugin should have configuration properties prefixed with its name.
# If name has 'default-' prefix it will be used by default in data set Data View.
reporting-plugins = demo-reporter

# Label of the plugin which will be shown for the users.
demo-reporter.label = Show Dataset Size
# Comma separated list of dataset type codes which can be handled by this plugin.
demo-reporter.dataset-types = UNKNOWN
# Plugin class specification (together with the list of packages this class belongs to).
demo-reporter.class = ch.systemsx.cisd.openbis.dss.generic.server.plugins.demo.DemoReportingPlugin
# The property file. Its content will be passed as a parameter to the plugin.
demo-reporter.properties-file =

# Plugin that allows to show content of Main Data Set as an OpenBIS table
# tsv-viewer.label = TSV View
# tsv-viewer.dataset-types = TSV
# tsv-viewer.class = ch.systemsx.cisd.openbis.dss.generic.server.plugins.standard.TSVViewReportingPlugin
# tsv-viewer.properties-file =

# ---------------------------------------------------------------------------
# Data Set Validator Definitions
# ---------------------------------------------------------------------------

# Data set validators used to accept or reject data sets to be registered.
# Comma separated list of validator definitions.
data-set-validators = validator

# Definition of data set validator 'validator'
validator.data-set-type = HCS_IMAGE
validator.path-patterns = **/*.txt
validator.columns = id, description, size
validator.id.header-pattern = ID
validator.id.mandatory = true
validator.id.order = 1
validator.id.value-validator = ch.systemsx.cisd.etlserver.validation.HeaderBasedValueValidatorFactory
validator.id.header-types = compound, gene-locus
validator.id.compound.header-pattern = CompoundID
validator.id.compound.value-type = unique
validator.id.compound.value-pattern = CHEBI:[0-9]+
validator.id.gene-locus.header-pattern = GeneLocus
validator.id.gene-locus.value-type = unique
validator.id.gene-locus.value-pattern = BSU[0-9]+
validator.description.header-pattern = Description
validator.description.value-type = string
validator.description.value-pattern = .{0,100}
validator.size.header-pattern = A[0-9]+
validator.size.can-define-multiple-columns = true
validator.size.allow-empty-values = true
validator.size.value-type = numeric
validator.site.value-range = [0,Infinity)


# Comma separated names of processing threads. Each thread should have configuration properties prefixed with its name.
# E.g. 'code-extractor' property for the thread 'my-etl' should be specified as 'my-etl.code-extractor'
inputs=main-thread

# ---------------------------------------------------------------------------
# 'main-thread' thread configuration
# ---------------------------------------------------------------------------
# The directory to watch for incoming data.
main-thread.incoming-dir = data/incoming

# Specifies what should happen if an error occurs during dataset processing.
# By default this flag is set to false and user has to modify the 'faulty paths file'
# each time the faulty dataset should be processed again.
# Set this flag to true if the processing should be repeated after some time without manual intervention.
# Note that this can increase the server load.
main-thread.reprocess-faulty-datasets = false

# If 'true' then unidentified and invalid data sets will be deleted instead of being moved to 'unidentified' folder
# Allowed values:
#  - false   - (default) move unidentified or invalid data sets to 'unidentified' folder
#  - true    - delete unidentified or invalid data sets
# delete-unidentified = true

# Determines when the incoming data should be considered complete and ready to be processed.
# Allowed values:
#  - auto-detection - when no write access will be detected for a specified 'quite-period'
#  - marker-file		- when an appropriate marker file for the data exists.
# The default value is 'marker-file'.
main-thread.incoming-data-completeness-condition = marker-file

# Path to the script that will be executed before data set registration.
# The script will be called with two parameters: &lt;data-set-code&gt; and &lt;absolute-data-set-path&gt; (in the incoming dropbox).
# NOTE: before starting DSS server make sure the script is accessible and executable.
# main-thread.pre-registration-script = /example/scripts/my-script.sh

# Path to the script that will be executed after successful data set registration.
# The script will be called with two parameters: &lt;data-set-code&gt; and &lt;absolute-data-set-path&gt; (in the data store).
# NOTE: before starting DSS server make sure the script is accessible and executable.
# main-thread.post-registration-script = /example/scripts/my-script.sh

# ---------------- Plugin properties
# The extractor class to use for code extraction

main-thread.data-set-info-extractor = ch.systemsx.cisd.etlserver.DefaultDataSetInfoExtractor
# Separator used to extract the barcode in the data set file name
main-thread.data-set-info-extractor.entity-separator = ${data-set-file-name-entity-separator}
# The space
main-thread.data-set-info-extractor.space-code = TEST
# Location of file containing data set properties
#main-thread.data-set-info-extractor.data-set-properties-file-name = data-set.properties


# The extractor class to use for type extraction
main-thread.type-extractor = ch.systemsx.cisd.etlserver.SimpleTypeExtractor
main-thread.type-extractor.file-format-type = TIFF
main-thread.type-extractor.locator-type = RELATIVE_LOCATION
main-thread.type-extractor.data-set-type = HCS_IMAGE
main-thread.type-extractor.is-measured = true

# The storage processor (IStorageProcessor implementation)
main-thread.storage-processor = ch.systemsx.cisd.etlserver.DefaultStorageProcessor

# ---------------------------------------------------------------------------
# dss-rpc
# ---------------------------------------------------------------------------
# The dss-rpc section configures the RPC put functionality by providing a mapping between data
# set type and input thread parameters.
#
# The default input thread is specified by the dss-rpc.put-default key. If not specified, the first input
# thread will be used.
#
# Mappings are specified by dss-rpc.put.&lt;data-set-type-code&gt; = &lt;thread-name&gt;
#
# If this section is empty, then the first input thread will be used.
#
dss-rpc.put-default = main-thread
#dss-rpc.put.HCS_IMAGE = main-thread

# ---------------------------------------------------------------------------
# Sample dropbox configuration
# ---------------------------------------------------------------------------
# &lt;incoming-dir&gt; will be scanned for tsv files containing samples in standard
#   batch import format. Additionally the file should contain (in the comment)
#   definition of sample type and optionally the default space and registrator.
#   If the 'DEFAULT_SPACE' is defined, codes of the samples will be
#   automatically created, so 'identifier' column is not expected.
#   If 'USER' is defined, he will become a 'Registrator' of the samples.
#
# --- EXAMPLE FILE ---
#! GLOBAL_PROPERTIES_START
#! SAMPLE_TYPE = &lt;sample_type_code&gt;
#! GLOBAL_PROPERTIES_END
# identifier  parent     container    property1    property2
# /SPACE/S1   /SPACE/P1               value11      value21
# /SPACE/S1   /SPACE/P2               value12      value22
# --- END OF FILE ---
#
# --- EXAMPLE FILE (generate codes automatically, registrator specified) ---
#! GLOBAL_PROPERTIES_START
#! SAMPLE_TYPE = &lt;sample_type_code&gt;
#! USER = &lt;user_id&gt;
#! DEFAULT_SPACE = &lt;space_code&gt;
#! GLOBAL_PROPERTIES_END
# parent     container     property1    property2
# /SPACE/P1                value11      value21
# /SPACE/P2                value12      value22
# --- END OF FILE ---
#
# Directory scanned for files with samples
samples.incoming-dir = ${root-dir}/sample-dropbox
#
# Class responsible for handling files with samples definition
samples.dataset-handler = ch.systemsx.cisd.etlserver.SampleRegisteringDropbox
#
# The path to the error logs directory
samples.dataset-handler.error-log-dir = ${root-dir}/error-log
#
# Prefix of samples with automatically created codes. Default value: 'S'.
samples.dataset-handler.sample-code-prefix = AS
#
# Settings not relevant to sample dropbox, but required by DSS
samples.incoming-data-completeness-condition = auto-detection
samples.data-set-info-extractor = ch.systemsx.cisd.etlserver.DefaultDataSetInfoExtractor
samples.type-extractor = ch.systemsx.cisd.etlserver.SimpleTypeExtractor
samples.storage-processor = ch.systemsx.cisd.etlserver.DefaultStorageProcessor

#
# Reasearch Collection - ELN Plugin
#
# rc-exports-api-limit-data-size-megabytes=4000
# rc-exports-api-service-document-url=
# rc-exports-api-user=
# rc-exports-api-password=

#
# Zenodo - ELN Plugin
#
# zenodo-exports-api-limit-data-size-megabytes=4000
# zenodo-exports-api-zenodoUrl=https://zenodo.org/
</pre>
</div></div><p>Because the Data Store Server communicates with the openBIS Server the following properties have to be changed:</p><ul><li><code>server-url</code>: Here only the host name has to be changed.</li><li><code>username/password</code>: Data Store Server is just a user for the openBIS Server. It should have the role <code>SPACE_ETL_SERVER</code> or <code>INSTANCE_ETL_SERVER</code>.</li></ul><h3 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ProductionsetupwithProxy">Production setup with Proxy</h3><p>A typical production scenario is when a proxy (typically Apache) is used at the front of AS and DSS, this have two main advantages:</p><ul><li>Users will be accessing the same domain and port, browsers are known to be friendlier to this setup.</li><li>The proxy can provide an https connector.  </li></ul><p>When these requirements are met is possible to comment out the <strong>download-url </strong>parameter from service.properties. As a consequence of this, the URLs provided by the system will be relative to the current domain and port of the application.</p><h3 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-SegmentedStore">Segmented Store</h3><p>Below the store root directory (specified by property <code>storeroot-dir</code>) the data is organized in segments called <em>shares</em>. Each share is a sub directory. The name of this sub directory is a number. It is also the share ID. A share can be a symbolic link to some shared directory.</p><p>On start up the DSS automatically creates share 1. An existing store is migrated by moving all data into share 1. Administrators can create new shares by creating new sub folders or symbolic links to sub folders readable and writable by the user running DSS.</p><p>Incoming directories are automatically associated to shares. These shares are called <em>incoming shares</em>. All data sets are stored in the incoming share associated on DSS start up. For each incoming directory DSS tries to move an empty file from the incoming directory to a share. The first share for which this move is successful becomes the associated incoming share. Each incoming directory has to have an associated incoming share. Several incoming directories can have the same share.</p><p>It is possible to force the assignment of an incoming share for a dropbox in the plugin.properties using the optional <code>incoming-share-id</code> property.  The incoming share specified in this way does not have to be on the same disk as incoming folder.</p><p>Segmenting the data store allows to add memory when it is needed. An administrator has just to mount a new hard disk or and NFS folder. After creating a symbolic link in the data store root directory the memory is available.</p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ShufflingDataSetsManually">Shuffling Data Sets Manually</h4><p>The script <code>share-manager.sh</code> (inside <code>&lt;installation directory&gt;/servers/datastore_server</code>) allows to move manually data sets to another share:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>./sharemanager.sh move-to &lt;share id&gt; &lt;data set code 1&gt; [&lt;data set code 2&gt; &lt;data set code 3&gt; ...] 
</pre>
</div></div><p> The user is asked for user ID and password.</p><p>The following command lists all shares and their free space:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>./sharemanager.sh list-shares
</pre>
</div></div><pre><br/></pre><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ShufflingDataSetsAutomatically">Shuffling Data Sets Automatically</h4><p>In order to be used by DSS the <code>SegmentedStoreShufflingTask</code> maintenance task is needed to shuffle data sets from full incoming shares or shares with set withdraw flag to the freshly added share (which is called an <em>external share</em>). Here is a typical configuration for this maintenance task:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedHeader panelHeader" style="border-bottom-width: 1px;"><b>service.properties</b></div><div class="preformattedContent panelContent">
<pre>maintenance-plugins = &lt;other maintenance plugins&gt;, store-shuffler
store-shuffler.class = ch.systemsx.cisd.etlserver.plugins.SegmentedStoreShufflingTask
store-shuffler.shuffling.class = ch.systemsx.cisd.etlserver.plugins.SimpleShuffling
# Data will be moved from the incoming share when the amount of free space on it will be lower than this number:
store-shuffler.shuffling.minimum-free-space-in-MB = 1024
store-shuffler.shuffling.share-finder.class = ch.systemsx.cisd.etlserver.plugins.SimpleShufflingShareFinder
# Nothing is moved to the share if the amount of free space is below that mark.
store-shuffler.shuffling.share-finder.minimum-free-space-in-MB = 1024
store-shuffler.interval = 86400
</pre>
</div></div><p>The maintenance task shuffles data sets from incoming shares which have less then 1GB free space to the share which the most free space. The task is executed every day (86400 seconds) once.</p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-SpeedandSpeedHint">Speed and Speed Hint</h4><p>Usually different shares are located on different (remotely) mounted disk drives. For that reason the data accessing speed among the shares can be quite different. Shuffling (and also unarchiving) can be controlled by associating a relative speed value to each share. The <strong>speed</strong> is a number between 0 and 100. Large numbers mean faster reading access. The speed is an arbitrary number which allows to compare data accessing speed between two different share. For example, if share 1 has speed 30 and share 2 has speed 50 then the data access from share 2 is faster than from share 1.</p><p><a href="#InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Shareproperties">Share properties</a> explains how to configure the speed of a share. If there is no explicit configuration a speed of 50 is assumed.</p><p>During data set registration a data set can be provided with a <strong>speed hint</strong> which can be used during shuffling to find an appropriated share. The speed hint is a number between -100 and +100. A positive value means that shares with that value or higher are preferred. A negative speed hint means that shares with same absolute value or less are preferred. For example, a data set with speed hint -30 prefers to be shuffled into a slow share of speed 30 or less.</p><p>Currently speed hints can be set only in jython drop-boxes. The default speed hint is -50.</p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Shareproperties">Share properties</h4><p>Each share can be configured via a <code>share.properties</code> file stored the share's root folder.</p><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><th class="confluenceTh"><p>Property Name</p></th><th class="confluenceTh"><p>Default Value</p></th><th class="confluenceTh"><p>Meaning</p></th></tr><tr><td class="confluenceTd"><p>speed</p></td><td class="confluenceTd"><p>50</p></td><td class="confluenceTd"><p>The share's speed. Must be a number between 0 and 100</p></td></tr><tr><td class="confluenceTd"><p>shuffle-priority</p></td><td class="confluenceTd"><p>SPEED</p></td><td class="confluenceTd"><p>Taken into account by the algorithm of <a href="#InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ch.systemsx.cisd.openbis.dss.generic.shared.StandardShareFinder">StandardShareFinder</a> <span class="confluence-link"> </span>. Valid values are <code>SPEED</code> and <code>MOVE_TO_EXTENSION</code>. The property configures which criteria is more important when considering a data set reciding on an incoming share - MOVE_TO_EXTENSION means the data set will always be moved to extension share even if the current incoming share is a better speed match for the data set. SPEED instructs the algorithm to find the best share with regards to the data set speed hint even if it is an incoming share.</p></td></tr><tr><td class="confluenceTd"><p>withdraw-share</p></td><td class="confluenceTd"><p><code>false</code></p></td><td class="confluenceTd"><p>If set to <code>true</code> indicates that this share should be emptied by moving all its data sets to other shares. This flag is useful if a share should be withdrawn. It can be removed if it is empty (DSS admin will be informed by an e-mail). Note, that in case of incoming shares, new data sets might be added afterwards.</p></td></tr><tr><td colspan="1" class="confluenceTd">ignored-for-shuffling</td><td colspan="1" class="confluenceTd"><code>false</code></td><td colspan="1" class="confluenceTd">If set <code>true</code> this share will not be taken into account for shuffling from/to this share.</td></tr><tr><td colspan="1" class="confluenceTd">unarchiving-scratch-share</td><td colspan="1" class="confluenceTd"><code>false</code></td><td colspan="1" class="confluenceTd">If set <code>true</code> this share can only be used as a scratch share for unarchiving using <code>MultiDataSetArchiver</code>. For more details see <a href="/display/openBISDoc2010/Multi+data+set+archiving">Multi data set archiving</a>.</td></tr><tr><td colspan="1" class="confluenceTd">experiments</td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd">Comma-separated list of experiment identifiers. This property is only used by <code> <a href="#InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ch.systemsx.cisd.openbis.dss.generic.shared.ExperimentBasedShareFinder">ExperimentBasedShareFinder</a>.</code></td></tr><tr><td colspan="1" class="confluenceTd">data-set-types</td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd">Comma-separated list of dataset type codes. This property is only used by <a href="#InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ch.systemsx.cisd.openbis.dss.generic.shared.DataSetTypeBasedShareFinder">DataSetTypeBasedShareFinder</a>.</td></tr></tbody></table></div><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ShareFinder">Share Finder</h4><p>For shuffling as well as unarchiving a strategy is need to find an appropriated share for the data set. It can consider the speed hint of the data set. The finding strategy is a Java class implementing <code>ch.systemsx.cisd.openbis.dss.generic.shared.IShareFinder</code>. It is specified by the properties starting with <code>&lt;prefix&gt;.share-finder</code>. The concrete finder is specified by the fully-qualified class name defined by the property <code>&lt;prefix&gt;.share-finder.class</code>. The following share finders are available:</p><h5 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ch.systemsx.cisd.openbis.dss.generic.shared.SimpleShareFinder">ch.systemsx.cisd.openbis.dss.generic.shared.SimpleShareFinder</h5><p>First it searches for shares with speed matching exactly the absolute value of the speed hint. If nothing found it does the same search for shares with speed above/below depending on the sign of the speed hint. If nothing found in this step it does the search for the third time but ignoring the speed hint.</p><p>The search is the following:<br/>It first tries to find the external share with most free space which has enough space for the data set. If no such share is found it does the same for incoming shares.</p><h5 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ch.systemsx.cisd.etlserver.plugins.SimpleShufflingShareFinder">ch.systemsx.cisd.etlserver.plugins.SimpleShufflingShareFinder</h5><p>As in <code>SimpleShareFinder</code> it tries to find first a share with matching speed, second a share respecting speed hint, and third a share ignoring speed hint.</p><p>Each time it searches for a share with most free space which has at least the space for the amount specified by the configuration parameter <code>minimum-free-space-in-MB</code> (default value 1024).</p><h5 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ch.systemsx.cisd.openbis.dss.generic.shared.SpeedOptimizedShareFinder">ch.systemsx.cisd.openbis.dss.generic.shared.SpeedOptimizedShareFinder</h5><p>First it searches for an extension share with matching speed and most free space. If nothing found it searches for an extension share with a speed respecting the speed hint. If this isn't successful it uses <code>ch.systemsx.cisd.openbis.dss.generic.shared.SimpleShareFinder</code> but ignoring speed hint.</p><h5 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ch.systemsx.cisd.openbis.dss.generic.shared.StandardShareFinder">ch.systemsx.cisd.openbis.dss.generic.shared.StandardShareFinder</h5><p>The search algorithm of this ShareFinder considers all shares with enough free space and with reset withdraw flag as potential &quot;candidates&quot; (The free space of the data set &quot;home&quot; share is increased by the data set size). The best candidate is elected by the following rules:</p><ol><li>An extension share is preferred above an incoming share.</li><li>A share whose speed matches the speed requirements of the data set is preferred. If there is more than one share matching in the same way then choose the one with speed closest to absolute value of speed hint.</li><li>If all candidates have the same parameters for (1) and (2) choose the share with most free space.</li></ol><p>The priority of points (1) and (2) can be swapped if the current location of the data set is an incoming share and it has a shuffle priority SPEED.</p><p>Generally the StandardShareFinder tends to move data sets from incoming to extension shares. A data set can only be moved from extension to incoming share by an unarchiving operation if at the time of unarchiving all extension shares (regardless of their speeds) are full.</p><p>The configuration parameter <code>incoming-shares-minimum-free-space-in-MB</code> can be specified for the StandardShareFinder. It allows to configure a threshold of free space that should always be available on the incoming shares.</p><h5 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ch.systemsx.cisd.openbis.dss.generic.shared.ExperimentBasedShareFinder">ch.systemsx.cisd.openbis.dss.generic.shared.ExperimentBasedShareFinder</h5><p>This share finder looks for a share which is associated with one or more experiments. If the data set to moved belongs to one of the specified experiments and the share has enough space the finder returns this share. The association of a share with some experiments is done by the property <code>experiments</code> of the properties file <code>share.properties</code>. The value is a comma-separated list of experiment identifiers.</p><h5 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ch.systemsx.cisd.openbis.dss.generic.shared.DataSetTypeBasedShareFinder">ch.systemsx.cisd.openbis.dss.generic.shared.DataSetTypeBasedShareFinder</h5><p>This share finder looks for a share which is associated with one or more data set types. If the data set to be moved is of one of the specified types and the share has enough space the finder returns this share. The association of a share with some data set type is done by the property <code>data-set-types </code>of the properties file <code>share.properties</code>. The value is a comma-separated list of data set type codes.</p><h5 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ch.systemsx.cisd.openbis.dss.generic.shared.MappingBasedShareFinder">ch.systemsx.cisd.openbis.dss.generic.shared.MappingBasedShareFinder</h5><p>This share finder reads a mapping file specified by property <code>mapping-file</code>. It is used to get a list of share IDs. The first share from this list is returned which fulfills the following conditions: The share exists and its free space is larger than the size of the data set. For more details on the mapping file see <a href="/display/openBISDoc2010/Mapping+File+for+Share+Ids+and+Archiving+Folders">Mapping File for Share Ids and Archiving Folders</a>.</p><h3 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-DataSources">Data Sources</h3><p>Often a DSS needs also relational databases. Such databases can be internal ones feeded when data sets are registered or external ones providing additional information for data set registration, processing or reporting plugins. Data sources should be defined as <a href="/display/openBISDoc2010/Core+Plugins">core plugins</a> of type <code>data-sources</code>. The following properties are understood:</p><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><th class="confluenceTh">Property name</th><th class="confluenceTh">Description</th></tr><tr><td colspan="1" class="confluenceTd">factory-class</td><td colspan="1" class="confluenceTd">Optional fully-qualified name of a class implementing <code>ch.systemsx.cisd.openbis.generic.shared.util.IDataSourceFactory</code>. The properties below are understood if the default factory class <code>ch.systemsx.cisd.openbis.dss.generic.sharedDefaultDataSourceFactory</code> is used.</td></tr><tr><td class="confluenceTd">version-holder-class</td><td class="confluenceTd">Optional fully-qualified name of a class implementing <code>ch.systemsx.cisd.openbis.dss.generic.shared.IDatabaseVersionHolder</code>. This property is only used if this is a data source of an internal database where DSS takes care of creating and migrating the database.</td></tr><tr><td colspan="1" class="confluenceTd">databaseEngineCode</td><td colspan="1" class="confluenceTd">Mandatory property specifying the database engine. Currently only <code>postgresql</code> is supported.</td></tr><tr><td colspan="1" class="confluenceTd">basicDatabaseName</td><td colspan="1" class="confluenceTd">Mandatory property specifying the first part of the database name.</td></tr><tr><td colspan="1" class="confluenceTd">databaseKind</td><td colspan="1" class="confluenceTd">Mandatory property specifying the second part of the database name. The full database name reads &lt;basicDatabaseName&gt;_&lt;databaseKind&gt;.</td></tr><tr><td colspan="1" class="confluenceTd">scriptFolder</td><td colspan="1" class="confluenceTd">Folder containing database schema SQL scripts. This property is mandatory for internal databases. For external databases it will be ignored.</td></tr><tr><td colspan="1" class="confluenceTd">urlHostPart</td><td colspan="1" class="confluenceTd">Optional host part of the database URL. This is the host name with an optional port number. Default value is a standard value for the selected database engine assuming that database server and DSS running on the same machine.</td></tr><tr><td colspan="1" class="confluenceTd">owner</td><td colspan="1" class="confluenceTd">Owner of the database <code>&lt;basicDatabaseName&gt;_&lt;databaseKind&gt;</code>. Default: User who started up DSS</td></tr><tr><td colspan="1" class="confluenceTd">password</td><td colspan="1" class="confluenceTd">Owner password.</td></tr><tr><td colspan="1" class="confluenceTd">adminUser</td><td colspan="1" class="confluenceTd">Administrator user of the database server. Default is defined by the selected database engine.</td></tr><tr><td colspan="1" class="confluenceTd">adminPassword</td><td colspan="1" class="confluenceTd">Administrator password.</td></tr></tbody></table></div><p>Example:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>version-holder-class = ch.systemsx.cisd.openbis.dss.etl.ImagingDatabaseVersionHolder
databaseEngineCode = postgresql
basicDatabaseName = imaging
urlHostPart = ${imaging-database.url-host-part:localhost}
databaseKind = ${imaging-database.kind:prod}
scriptFolder = ${screening-sql-root-folder:}sql/imaging
</pre>
</div></div><h3 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Simpledatasources">Simple data sources</h3><p>If the database used in data store server is not managed by openBIS and doesn't follow openBIS conventions on versioning etc. it is possible to specify it with <span style="font-size: 10.0pt;line-height: 13.0pt;">SimpleDataSourceFactory like in the following example</span></p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>factory-class = ch.systemsx.cisd.openbis.dss.generic.shared.SimpleDataSourceFactory
database-driver = oracle.jdbc.driver.OracleDriver
database-url = jdbc:oracle:thin:@test.test.com:1111:orcldatabase-driver
database-username = test
database-password = test
# database-max-idle-connections = 
# database-max-active-connections =
# database-max-wait-for-connection = # value in miliseconds
# database-active-connections-log-interval = # value in miliseconds
# validation-query = </pre>
</div></div><h3 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ReportingandProcessingPlugins"><span style="font-size: 14.0pt;">Reporting and Processing Plugins</span></h3><p>The property <code>reporting-plugins</code> and <code>processing-plugins</code> are comma-separated lists of reporting/processing plugin names. Each reporting plugin should be able to take a set of data sets chosen by the user and produce a tabular result in a short time. The result table is shown to the user and can be exported to a tab separated file. A processing plugin is similar but it does not creates data immediately presented to the user. It can be used to do some time-consuming processing for the data sets selected by the user. Often, processing plugins inform the user via e-mail after finishing.</p><p>The name of all configuration properties for a particular reporting/processing plugin starts with <code>&lt;plugin name&gt;.</code>. The following properties are understood:</p><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><th class="confluenceTh"><p>Property name</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p><code>label</code></p></td><td class="confluenceTd"><p>Label of the plugin which will be shown for the users. This property is mandatory.</p></td></tr><tr><td class="confluenceTd"><p><code>dataset-types</code></p></td><td class="confluenceTd"><p>Comma separated list of data set type codes which can be handled by this plugin. This property is mandatory.</p></td></tr><tr><td class="confluenceTd"><p><code>class</code></p></td><td class="confluenceTd"><p>Fully qualified Java class name of the plugin. It has to implemented <code>IReportingPluginTask</code>/<code>IProcessingPluginTask</code>. This property is mandatory.</p></td></tr><tr><td class="confluenceTd"><p><code>properties-file</code></p></td><td class="confluenceTd"><p>The property file. Its content will be passed as a parameter to the plugin.</p></td></tr><tr><td class="confluenceTd"><p><code>servlet.class</code></p></td><td class="confluenceTd"><p>Fully qualified Java class name of an optional Servlet need.</p></td></tr><tr><td class="confluenceTd"><p><code>servlet.path</code></p></td><td class="confluenceTd"><p>Path pattern relative to the DSS application URL to which the servlet is bound. This property is mandatory if <code>servlet.class</code> is specified.</p></td></tr><tr><td class="confluenceTd"><p><code>servlets</code></p></td><td class="confluenceTd"><p>Comma separated list of names of servlets needed by the plugin. For each name a set of properties with prefix <code>&lt;name&gt;.</code> is assumed. All of them have the same sematics as the properties starting with <code>servlet.</code>.</p></td></tr></tbody></table></div><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-DefaultPluginusedinDataView">Default Plugin used in Data View</h4><p>In detail view of a dataset in openBIS Application the Data View section by default shows <code>'Files (Smart View)'</code>. If there are reporting plugins specified for dataset's type users can query a reporting plugin which results will be shown in the Data View. To show reporting plugin results by default for specific dataset types (instead of <code>'Files (Smart View)'</code>) name of the plugin should start with <code>default-</code> prefix, e.g.: <code>default-tsv-viewer</code> could be specified as defult plugin for datasets of type <code>TSV</code>.</p><div class="confluence-information-macro confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"> </span><div class="confluence-information-macro-body"><ul class="alternate"><li>If for a certain dataset type there is more than one reporting plugin specified as default then the first plugin using plugin labels in alphabetical order will be chosen by default.</li><li>If you have two data set types, e.g.: <code>TSV</code> and <code>CSV</code>, and want to be able to use the same plugin implementation for both, but choose it by default only for dataset type <code>TSV</code> you need to configure two separate plugins. Both configurations should have the same <code>class</code> property value but different <code>dataset-types</code>, and additionally the plugin configuration for datasets of type <code>TSV</code> should have a name starting with <code>default-</code> prefix.</li></ul></div></div><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Existingreportingplugins">Existing reporting plugins</h4><h5 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-TSVViewer">TSV Viewer</h5><h6 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Description">Description</h6><p>Allows to show content of <a href="/display/openBISDoc2010/Main+Data+Set">Main Data Set</a> as an OpenBIS table. To become a <code> <a href="/display/openBISDoc2010/Main+Data+Set">Main Data Set</a> </code>, file must be either the only file in the data set directory or must match a given regular expression specific to given data set type. Such a regular expression can be configured by the administrator <strong>Data Set-&gt;Types-&gt;Edit-&gt;Main Data Set Pattern</strong>. This is one of a few reporting plugins working on files with tabular data such as TSV (tab separated value) files, CSV (comma separated value) files or Excel files (supported extensions: XSL, XSLS).</p><h6 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Configuration">Configuration</h6><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre># Add plugin id to the reporting-plugins, in our case: tsv-viewer
reporting-plugins = tsv-viewer
# Set the label, that will be visible to the OpenBIS users
tsv-viewer.label = TSV View
# Specify data set types that should be viewable with TSV Viewer
tsv-viewer.dataset-types = TSV
tsv-viewer.class = ch.systemsx.cisd.openbis.dss.generic.server.plugins.standard.TSVViewReportingPlugin
tsv-viewer.properties-file =
# Optional properties:
# - separator of values in the file, significant for TSV and CSV files; default: tab
#tsv-viewer.separator = ;
# - whether lines beginning with '#' should be ignored by the plugin; default: true
#tsv-viewer.ignore-comments = false
# - excel sheet name or index (0 based) used for the excel file (.xsl or .xslx); default: 0 (first sheet)
#tsv-viewer.excel-sheet = example_sheet_name
</pre>
</div></div><h5 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-JythonBasedReportingPlugin">Jython Based Reporting Plugin</h5><h6 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Description.1">Description</h6><p>Creates a report based on a jython script. For more details see <a href="/display/openBISDoc2010/Jython-based+Reporting+and+Processing+Plugins">Jython-based Reporting and Processing Plugins</a>.</p><h6 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Example">Example</h6><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedHeader panelHeader" style="border-bottom-width: 1px;"><b>plugin.properties</b></div><div class="preformattedContent panelContent">
<pre>label = My Report
class = ch.systemsx.cisd.openbis.dss.generic.server.plugins.jython.JythonBasedReportingPlugin
dataset-types = MY_DATA_SET
script-path = script.py
</pre>
</div></div><p><br/></p><h5 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-JythonBasedAggregationReportingPlugin">Jython Based Aggregation Reporting Plugin</h5><h6 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Description.2">Description</h6><p>Creates an aggregation report based on a jython script. Note, that property <code>dataset-types</code> isn't needed and will be ignored. Aggregation reporting plugins can be used only via the Query API. For more details see <a href="/display/openBISDoc2010/Jython-based+Reporting+and+Processing+Plugins">Jython-based Reporting and Processing Plugins</a>.</p><h6 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Example.1">Example</h6><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedHeader panelHeader" style="border-bottom-width: 1px;"><b>plugin.properties</b></div><div class="preformattedContent panelContent">
<pre>label = My Report
class = ch.systemsx.cisd.openbis.dss.generic.server.plugins.jython.JythonBasedAggregationServiceReportingPlugin
script-path = script.py
</pre>
</div></div><p><br/></p><h5 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ReportingPluginDecorator">Reporting Plugin Decorator</h5><h6 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Description.3">Description</h6><p>A reporting plugin which modifies the table produced by another reporting plugin. The modification is done by a transformation class which implements <code>ch.systemsx.cisd.openbis.generic.shared.basic.ITableModelTransformation</code>. Currently there is only the transformation<code> ch.systemsx.cisd.openbis.dss.generic.server.plugins.standard.EntityLinksDecorator</code> which turns cells of some columns into cells with links to a material or a sample.</p><h6 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Configuration.1">Configuration</h6><p>Here is an example of a configuration which decorates a TSV viewer plugin which produces a table with a material and a sample column:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>label = Example with Materials and Samples
dataset-types = MY_DATA_SET_TYPE
class = ch.systemsx.cisd.openbis.dss.generic.server.plugins.standard.DecoratingTableModelReportingPlugin
# The actual reporting plugin which creates a table
reporting-plugin.class = ch.systemsx.cisd.openbis.dss.generic.server.plugins.standard.TSVViewReportingPlugin
reporting-plugin.separator = ,
# The transformation applied to the table return by the actual reporting plugin
transformation.class = ch.systemsx.cisd.openbis.dss.generic.server.plugins.standard.EntityLinksDecorator
# Link columns is a list of comma-separated column IDs which should be decorated. 
transformation.link-columns = GENE_ID, BARCODE
# Entity kind is either MATERIAL or SAMPLE
transformation.GENE_ID.entity-kind = MATERIAL
# The type of the material. Note, it is assumed that the column contains only the material code.
transformation.GENE_ID.material-type = GENE
transformation.BARCODE.entity-kind = SAMPLE
# Optional default property to be used if the column contains only sample codes instead of full identifiers.
transformation.BARCODE.default-space = DEMO</pre>
</div></div><p><br/></p><h3 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ArchiverPlugin">Archiver Plugin</h3><p>Archiver is an optional plugin used to archive and unarchive data sets. It receives a set of datasets chosen by the user or automatic archiver maintenance task performs its task on Data Store Server and changes status of data sets in openBIS database in the end.</p><p>The archiver plugin is also needed if freshly registered data sets should immediately be archived (mainly for backup purposes). For more details see <a href="#InstallationandAdministratorsGuideoftheopenBISDataStoreServer-PostRegistration">Post Registration</a> and <a href="#InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ArchivingPostRegistrationTask">ArchivingPostRegistrationTask</a>.</p><p>The name of all configuration properties for a particular reporting plugin start with <code>archiver.</code>.</p><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><th class="confluenceTh"><p>Property name</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p>archiver.class</p></td><td class="confluenceTd"><p>The archiver class, see the sections below for examples.</p></td></tr><tr><td class="confluenceTd"><p>archiver.share-finder.class</p></td><td class="confluenceTd"><p>(optional) A <a href="#InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ShareFinder">#Share Finder</a> strategy selecting a destination share when unarchiving datasets. The default value of this property is <code>ch.systemsx.cisd.openbis.dss.generic.shared.StandardShareFinder</code>. <br class="atl-forced-newline"/>Specific share finder properties must start with <code>archiver.share-finder.</code> e.g. <code>archiver.share-finder.minimum-free-space-in-MB</code></p></td></tr><tr><td class="confluenceTd"><p>archiver.synchronize-archive</p></td><td class="confluenceTd"><p>(optional) indicates if data should be synchronized when local copy is different than one in archive (default: true)</p></td></tr><tr><td colspan="1" class="confluenceTd"><p>archiver.batch-size-in-bytes</p></td><td colspan="1" class="confluenceTd"><p>(optional) D<span>atasets will be archived in batches. </span>The datasets will be split in batches of roughly the same size (in bytes) controlled by the value of this property. Default is 1 gigabyte.</p></td></tr><tr><td colspan="1" class="confluenceTd">archiver.pause-file</td><td colspan="1" class="confluenceTd">Path (absolute or relative to store root) of an empty file. If this file is present starting archiving/unarchiving will be paused until this file has been removed. This property is useful for archiving media/facilities with maintenance downtimes. Default value: <code>pause-archiving</code></td></tr><tr><td colspan="1" class="confluenceTd">archiver.pause-file-polling-time</td><td colspan="1" class="confluenceTd">Time interval between two checks whether pause file still exists or not. Default value: <code>10 min</code></td></tr></tbody></table></div><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-RsyncArchiver">Rsync Archiver</h4><p>Rsync Archiver (<code>ch.systemsx.cisd.openbis.dss.generic.server.plugins.standard.RsyncArchiver</code>) is an example archiver implementation that stores the archived data in a specified <strong>destination</strong> folder. The destination folder doesn't have to be on the same file system as the data store. It can also be:</p><ul class="alternate"><li>a mounted remote folder,</li><li>a remote folder accessible via SSH (add <code>&lt;hostname&gt;:</code> prefix to folder path in configurarion),</li><li>a remote folder accessible via an rsync server (add <code>&lt;hostname&gt;:&lt;rsync module name&gt;</code> prefix to folder path in configurarion).</li></ul><p>Apart from standard archiver task properties the following specific properties are understood:</p><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><th class="confluenceTh"><p>Property name</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p>destination</p></td><td class="confluenceTd"><p>Path to the destination folder where archived data sets will be stored.</p></td></tr><tr><td class="confluenceTd"><p>rsync-password-file</p></td><td class="confluenceTd"><p>(optional) Path to password file used when rsync module is specified.</p></td></tr><tr><td class="confluenceTd"><p>find-executable</p></td><td class="confluenceTd"><p>(optional) Path to GNU find executable that is used to verify data integrity. If not specified default find executable found in the system, which should be the right one on most <strong>Linux</strong> distributions, but <strong>not on Mac OS</strong>.</p></td></tr><tr><td class="confluenceTd"><p>timeout</p></td><td class="confluenceTd"><p>(optional) Network I/O timeout in seconds. The default value for this parameter is 15 seconds.</p></td></tr><tr><td class="confluenceTd"><p>only-mark-as-deleted</p></td><td class="confluenceTd"><p>This is a flag which tells the archiver whether to delete data sets or only to mark data sets as deleted in the archive. In the second case a marker file (file name is the data set code) will be added to the folder <code>&lt;destination&gt;/DELETED</code>. Default value for this parameter is <code>true</code>.</p></td></tr><tr><td colspan="1" class="confluenceTd"><span>verify-checksums</span></td><td colspan="1" class="confluenceTd"><p>(optional) This flag specifies if CRC32 checksum check should be performed. The default is <code>true</code>.</p></td></tr><tr><td colspan="1" class="confluenceTd"><span>batch-size-in-bytes</span></td><td colspan="1" class="confluenceTd">(optional) This allows to control when the archiving status of just archived data sets will be updated. This is the case when the sum of data set sizes exceeds the specified threshold. Default value is 1GB.</td></tr><tr><td colspan="1" class="confluenceTd">temp-folder</td><td colspan="1" class="confluenceTd"><p>(optional) Temporary folder to be used in sanity check of archived data sets on an unmounted remote archive location. Default is just the data store itself.</p><p>In case of TarArchiver this temporary folder is also used to unpack the TAR archive file for sanity check.</p></td></tr></tbody></table></div><p>Example configuration:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>archiver.class = ch.systemsx.cisd.openbis.dss.generic.server.plugins.standard.RsyncArchiver
archiver.share-finder.class = ch.systemsx.cisd.openbis.dss.generic.shared.SimpleShareFinder
archiver.destination = hostname:/path/to/destination/folder
archiver.timeout = 20
</pre>
</div></div><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ZipArchiver">Zip Archiver</h4><p>This archiver (<code>ch.systemsx.cisd.openbis.dss.generic.server.plugins.standard.ZipArchiver</code>) archives data sets in ZIP files together with meta data (including properties) of the data set, the experiment and optional the sample to which the data set belongs. Also the meta data of the container data set (if present) are included (with properties, experiment and sample). The meta data are stored in the tab-separated file <code>meta-data.tsv</code> inside the ZIP file. Each data set will be stored in one ZIP file named <code>&lt;data set code&gt;.zip</code>.</p><p>The location of the ZIP file is specified by a mapping file which allows to specify archive folders in accordance with experiment/project/space identifier of the data set. Note, that all archive folders have to be on mounted disks. For more details about syntax and resolving rules see <a href="/display/openBISDoc2010/Mapping+File+for+Share+Ids+and+Archiving+Folders">Mapping File for Share Ids and Archiving Folders</a>.</p><p>Note, that this archiver doesn't work properly if HDF5 files are treated as folders.</p><p>Apart from standard archiver task properties the following specific properties are understood:</p><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><th class="confluenceTh"><p>Property name</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td colspan="1" class="confluenceTd"><p>only-mark-as-deleted</p></td><td colspan="1" class="confluenceTd"><p>This is a flag which tells the archiver whether to delete data sets or only to mark data sets as deleted in the archive. In the second case a marker file (file name is the data set code) will be added to the folder <code>&lt;archive folder&gt;/DELETED</code>. Default value for this parameter is <code>true</code>.</p></td></tr><tr><td class="confluenceTd"><span>verify-checksums</span></td><td class="confluenceTd">(optional) This flag specifies if CRC32 checksum check should be performed. The default is <code>true</code>.</td></tr><tr><td colspan="1" class="confluenceTd">default-archive-folder</td><td colspan="1" class="confluenceTd">This is the path to the archive which is used if mapping hasn't been specified or an appropriated archive folder couldn't be found in the mapping file. This is a mandatory property.</td></tr><tr><td colspan="1" class="confluenceTd"><p class="p1">default-small-data-sets-archive-folder</p></td><td colspan="1" class="confluenceTd"><span> <span>This is the path to the archive folder which is used for small data sets only. Which data sets are considered &quot;small&quot; is controlled by &quot;</span> </span> <span style="font-size: 10.0pt;line-height: 13.0pt;">small-data-sets-size-limit&quot; property. When the small data sets folder is defined then the small data sets limit has to be set as well<span>.</span> This folder is used only when t</span> <span>he mapping file hasn't been specified or an appropriated archive folder couldn't be found in the mapping file. This is an optional property.</span></td></tr><tr><td colspan="1" class="confluenceTd"><p class="p1">small-data-sets-size-limit</p></td><td colspan="1" class="confluenceTd">Controls which data sets are considered &quot;small&quot;. Data sets which size is smaller or equal to this property value are treated as &quot;small&quot;. Data sets which size is greater than this property value are treated as &quot;big&quot;. The limit is expressed in kilobytes. E.g. 1024 value of this property means that data sets which size is smaller or equal to 1MB are considered &quot;small&quot;. The limit is used when choosing between &quot;<span>default-archive-folder&quot; and &quot;<span>default-small-data-sets-archive-folder&quot; or between &quot;big&quot; and &quot;small&quot; folders defined in the mapping file.</span> </span></td></tr><tr><td colspan="1" class="confluenceTd">mapping-file</td><td colspan="1" class="confluenceTd">Path to the mapping file. This is an optional property. If not specified the <code>default-archive-folder</code> will be used for all data sets.</td></tr><tr><td colspan="1" class="confluenceTd">mapping-file.create-archives</td><td colspan="1" class="confluenceTd">If <code>true</code> the archive folders specified in the mapping file will be created if they do not exit. Default value is <code>false</code>.</td></tr><tr><td colspan="1" class="confluenceTd">compressing</td><td colspan="1" class="confluenceTd">If <code>true</code> compression is used when creating the archived data set. Otherwise an uncompressed ZIP file is created. Default value is <code>true</code>.</td></tr><tr><td colspan="1" class="confluenceTd">with-sharding</td><td colspan="1" class="confluenceTd">If <code>true</code> the path of the ZIP file is <code>&lt;archive folder&gt;/&lt;data store UUID&gt;/&lt;sharding levels&gt;/&lt;data set code&gt;/&lt;data set code&gt;.zip</code>. Otherwise the path reads <code>&lt;archive folder&gt;/&lt;data set code&gt;.zip</code>. Default value is <code>false</code>.</td></tr><tr><td colspan="1" class="confluenceTd">ignore-existing</td><td colspan="1" class="confluenceTd">If <code>true</code> then data sets that already exist in the archive (zip file exists and it is not empty) are ignored and not copied to the archive again. If <code>false</code> then data sets are always copied to the archive without checking if they exist. Default value is <code>false</code>.</td></tr></tbody></table></div><p>Note, that the property <code>synchronize-archive</code> will be ignored: An already archived data set will be archived again if archiving has been triggered.</p><p>It is recommended to use as the share finder <a href="#InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ch.systemsx.cisd.openbis.dss.generic.shared.MappingBasedShareFinder">MappingBasedShareFinder</a> for unarchiving.</p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-TarArchiver">Tar Archiver</h4><p>This archiver (<code>ch.systemsx.cisd.openbis.dss.generic.server.plugins.standard.TarArchiver</code>) archives data sets in TAR files. It is very similar to the ZIP archiver. It accepts all the configuration properties that the ZIP archiver accepts, except for the &quot;compressing&quot; property.</p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-AutomaticArchiver">Automatic Archiver</h4><p>Automatic Archiver <code>ch.systemsx.cisd.etlserver.plugins.AutoArchiverTask</code> is a maintenance task scheduled for repeated execution beginning at the specified time (optional - by default it is executed without delay after server starts) with regular intervals between subsequent executions.</p><p>Apart from standard maintenance task properties the following specific properties (all optional) are understood:</p><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><th class="confluenceTh"><p>Property name</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p><code>data-set-type</code></p></td><td class="confluenceTd"><p>Dataset type code of datasets that will be archived. By default all types will be archived.</p></td></tr><tr><td class="confluenceTd"><p><code>older-than</code></p></td><td class="confluenceTd"><p>Only data sets that are older than specified number of days will be archived (default = 30).</p></td></tr><tr><td class="confluenceTd"><p><code>policy.class</code></p></td><td class="confluenceTd"><p>Fully qualified class name of a policy that additionally filters data sets to be archived. <br class="atl-forced-newline"/>Specific policy can use additional properties with <code>policy</code> prefix.</p></td></tr><tr><td class="confluenceTd"><p><code>remove-datasets-from-store</code></p></td><td class="confluenceTd"><p>Indicates whether data sets will be removed from the data store upon archiving (default = false).</p></td></tr></tbody></table></div><p>By default all data sets with status <code>'AVAILABLE'</code> will be archived. Power users can prevent auto archiving of data sets by changing their status to <code>'LOCKED'</code>.</p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-AutomaticExperimentArchiver">Automatic Experiment Archiver</h4><p>This a maintenance task <code>ch.systemsx.cisd.etlserver.plugins.ExperimentBasedArchivingTask</code> which archives whole experiments if free disk space is below a configured threshold. Archiving a whole experiment means that all data sets of this experiments are archived.</p><p>As any maintenance task it is scheduled for repeated execution beginning at the specified time (optional - by default it is executed without delay after server starts) with regular intervals between subsequent executions.</p><p>The archiver archives one or more experiments starting with the oldest one. It stops if either a fixed number of experiments have been archived or the free disk space is above the threshold. Experiments are not archived if at least on data set is in the state <code>LOCKED</code>. The age of an experiment is defined by the youngest not archived data set.</p><p>Apart from standard maintenance task properties the following specific properties are understood:</p><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><th class="confluenceTh"><p>Property name</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p>monitored-dir</p></td><td class="confluenceTd"><p>This mandatory property specified the directory of the store whom's disk space is monitored. In the case the configured free space provider is <code>PostgresPlusFileSystemFreeSpaceProvider</code>, the monitored directory must be on the same physical hard disk as the monitored database.</p></td></tr><tr><td class="confluenceTd"><p>minimum-free-space-in-MB</p></td><td class="confluenceTd"><p>This mandatory property specifies the threshold (in MB) for free disk space on the share defined by <code>monitored-share</code>. If free disk space is below this threshold the archiving task will start archiving.</p></td></tr><tr><td class="confluenceTd"><p>excluded-data-set-types</p></td><td class="confluenceTd"><p>A comma-separated list of data set types. Data sets of those types will not be archived. They will not be used for calculating the age of an experiment.</p></td></tr><tr><td class="confluenceTd"><p>free-space-provider.class</p></td><td class="confluenceTd"><p>The classname of the free space provider to be used. The default is <code>ch.systemsx.cisd.common.filesystem.SimpleFreeSpaceProvider</code></p></td></tr><tr><td class="confluenceTd"><p>free-space-provider.*</p></td><td class="confluenceTd"><p>Properties for the configured free space provider</p></td></tr><tr><td class="confluenceTd"><p>estimated-data-set-size-in-KB.&lt;data-set-type&gt;</p></td><td class="confluenceTd"><p>Provides an estimation of the average size in kilobytes for a given data set type.</p></td></tr><tr><td class="confluenceTd"><p>estimated-data-set-size-in-KB.DEFAULT</p></td><td class="confluenceTd"><p>Default estimation of data set size. If no specific <code>estimated-data-set-size-in-KB.&lt;data-set-type&gt;</code> is present, then this property will be used to determine a data set size prior archiving. The property is optional.</p></td></tr></tbody></table></div><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Archiveclean-up">Archive clean-up</h4><p>Archives are not automatically updated when deleting data sets in openBIS. To purge archives from deleted data sets one has to configure a clean-up maintenance task - <code>ch.systemsx.cisd.etlserver.plugins.DeleteFromArchiveMaintenanceTask</code>.</p><p>Apart from the standard maintenance task properties the following specific properties will be accepted by the task:</p><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><th class="confluenceTh"><p>Property name</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p>delay-after-user-deletion</p></td><td class="confluenceTd"><p>Only data sets that have been deleted before more than <code>delay-after-user-deletion</code> minutes will be deleted from archive. Defaults to 0 (immediate deletion).</p></td></tr><tr><td class="confluenceTd"><p>status-filename</p></td><td class="confluenceTd"><p>A mandatory property keeping a filename, where the task tracks the last processed deletion. The path should be outside the DSS installation in order to survive DSS update installations.</p></td></tr></tbody></table></div><h3 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Freespaceproviders">Free space providers</h3><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-SimpleFreeSpaceProvider">SimpleFreeSpaceProvider</h4><p>The class <code>ch.systemsx.cisd.common.filesystem.SimpleFreeSpaceProvider</code> returns the free space on the file system of a hard drive. It works similarly to the command</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>$ df -h
</pre>
</div></div><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-PostgresPlusFileSystemFreeSpaceProvider">PostgresPlusFileSystemFreeSpaceProvider</h4><p>The class <code>ch.systemsx.cisd.openbis.dss.generic.shared.utils.PostgresPlusFileSystemFreeSpaceProvider</code> returns the free space on a hard drive as the sum from the file system free space and the free space detected in a PostgreSQL data source. Note that the data source is required to have the PostgreSQL extension <code>pgstattuple</code> installed.</p><p>The following configuration properties are available for <code>PostgresPlusFileSystemFreeSpaceProvider</code></p><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><td class="confluenceTd"><p>Property Name</p></td><td class="confluenceTd"><p>Description</p></td></tr><tr><td class="confluenceTd"><p>monitored-data-source</p></td><td class="confluenceTd"><p>The name of the data source to monitor</p></td></tr><tr><td class="confluenceTd"><p>execute-vacuum</p></td><td class="confluenceTd"><p>When set to <code>true</code> a PostgreSQL <code>VACUUM</code> command will be executed before the provider tries to calculate the free space. More</p></td></tr></tbody></table></div><h3 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-DataSetValidators">Data Set Validators</h3><p>Data Set Validators are used to accept or reject incoming data sets. They are specific for a data set type.</p><p>The property <code>data-set-validators</code> is a comma-separated list of validators for data sets. They are the names of the validators. The name of all configuration properties for a particular validator starts with <code>&lt;validator name&gt;.</code>. For an example, see the above-mentioned example of a <code>service.properties</code>. The following properties are understood:</p><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><th class="confluenceTh"><p>Property name</p></th><th class="confluenceTh"><p>Default value</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p><code>data-set-type</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>Mandatory data set type. The validator will be used only for data sets of this type.</p></td></tr><tr><td class="confluenceTd"><p><code>validator</code></p></td><td class="confluenceTd"><p><code>ch.systemsx.cisd.etlserver.validation.DataSetValidatorForTSV</code></p></td><td class="confluenceTd"><p>Fully-qualified name of a Java class implementing <code>IDataSetValidator</code>. This class must have a public constructor with a <code>Properties</code> object as an argument.</p></td></tr></tbody></table></div><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-DataSetValidatorforTSVFiles">Data Set Validator for TSV Files</h4><p>The default validator is <code>DataSetValidatorForTSV</code>. It is able to validate TAB-separated value (TSV) files. It is assumed, that the first line of such files contain the column headers. All headers should be unique (ie. no duplicated column headers). This validator understands the following properties:</p><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><th class="confluenceTh"><p>Property name</p></th><th class="confluenceTh"><p>Default value</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p><code>path-patterns</code></p></td><td class="confluenceTd"><p><code>*</code></p></td><td class="confluenceTd"><p>List of comma separated wild-card patterns for paths of files in the data set to be validated. The characters <code>*</code> and <code>?</code> are used in file names and parent folder names with the usual meaning (i.e. <code>*</code> = any number of any character, <code>?</code> = exactly one unspecified character). The character sequence <code>*</code> <code> <strong>/</strong> </code> <strong>is used to indicate any number of subdirectories. For example,</strong> <code> <strong>*</strong> </code> <code>/*.txt</code> means all files of file type <code>txt</code> anywhere in the data set.</p></td></tr><tr><td class="confluenceTd"><p><code>columns</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>List of comma separated names of column definitions. These column definitions are used</p><ul><li>to identify the columns in a TSV file and</li><li>to validate the values of the column. <br class="atl-forced-newline"/>For each name configuration properties are defined. The property names start with <code>&lt;column definition name&gt;.</code>.</li></ul></td></tr></tbody></table></div><p>A column definition understands the following properties:</p><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><th class="confluenceTh"><p>Property name</p></th><th class="confluenceTh"><p>Default value</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p><code>mandatory</code></p></td><td class="confluenceTd"><p><code>false</code></p></td><td class="confluenceTd"><p>If <code>true</code> a column as specified should be in the TSV file.</p></td></tr><tr><td class="confluenceTd"><p><code>order</code></p></td><td class="confluenceTd"><p><em>undefined</em></p></td><td class="confluenceTd"><p>Optional property. It specifies a column in the TSV file at a particular position. 1 means first column, 2 means second column etc.</p></td></tr><tr><td class="confluenceTd"><p><code>can-define-multiple-columns</code></p></td><td class="confluenceTd"><p><code>false</code></p></td><td class="confluenceTd"><p>If <code>true</code> more than one column with this definition can appear in the TSV file. This property will be ignored if <code>order</code> is defined or if <code>mandatory = true</code>.</p></td></tr><tr><td class="confluenceTd"><p><code>header-validator</code></p></td><td class="confluenceTd"><p><em>undefined</em></p></td><td class="confluenceTd"><p>Fully-qualified name of a Java class implementing <code>ch.systemsx.cisd.etlserver.validation.IColumnHeaderValidator</code>. It is used to either check that the header (in case <code>order</code> is specified) is valid or to find for a header a matching column definition. This class must have a public constructor with a <code>Properties</code> object as an argument.</p></td></tr><tr><td class="confluenceTd"><p><code>header-pattern</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>This property is mandatory if <code>header-validator</code> isn't specified. It specifies a regular expression for a column header validator based on regular expression as specified in <a class="external-link" href="http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/Pattern.html" rel="nofollow">http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/Pattern.html</a>.</p></td></tr><tr><td class="confluenceTd"><p><code>value-validator</code></p></td><td class="confluenceTd"><p><code>ch.systemsx.cisd.etlserver.validation.DefaultValueValidatorFactory</code></p></td><td class="confluenceTd"><p>Fully-qualified name of a Java class implementing <code>ch.systemsx.cisd.etlserver.validation.IValidatorFactory</code>. It generates the validator which is used to validate the values of a column in the TSV file. This class must have a public constructor with a <code>Properties</code> object as an argument.</p></td></tr></tbody></table></div><h5 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-DefaultValueValidatorFactory">DefaultValueValidatorFactory</h5><p>The default factory can generate four different types of value validators. It understands the following properties:</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/><col/></colgroup><tbody><tr><th class="confluenceTh"><p>Property name</p></th><th class="confluenceTh"><p>Default value</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p><code>value-type</code></p></td><td class="confluenceTd"><p><code>any</code></p></td><td class="confluenceTd"><p>Type of the value validator. The following values are allowed:</p><ul><li><code>any</code>: Any value is allowed.</li><li><code>numeric</code>: Value has to be a number.</li><li><code>string</code>: Value has to match a regular expression.</li><li><code>unique</code>: As <code>string</code>. In addition the column values have to be unique.</li><li><code>unique_groups</code>: As <code>string</code>. In addition selected parts of column values have to be unique.</li></ul></td></tr><tr><td class="confluenceTd"><p><code>allow-empty-values</code></p></td><td class="confluenceTd"><p><code>false</code></p></td><td class="confluenceTd"><p>If <code>true</code> empty cell values are allowed. This property is ignored if <code>value-type</code> is <code>any</code>, <code>unique</code> or <code>unique_groups</code>.</p></td></tr><tr><td class="confluenceTd"><p><code>empty-value-synonyms</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>An optional property of a comma-separated list of strings which are handled as synonyms for an empty value. This property is only used if <code>allow-empty-values</code> is set to <code>true</code>.</p></td></tr><tr><td class="confluenceTd"><p><code>value-pattern</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>Regular expression for a validator of type <code>string</code>, <code>unique</code>, and <code>unique_groups</code>. It is mandatory only for <code>string</code> and <code>unique_groups</code>.</p></td></tr><tr><td class="confluenceTd"><p><code>value-range</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>Optional range definition for validators of type <code>numeric</code>. The syntax is as follows</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>('('|'[') (-Infinity|&lt;floating point number&gt;) ',' (Infinity|&lt;floating point number&gt;) (']'|')')
</pre>
</div></div><p>Examples:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>(0,3.14159]
[0,Infinity) (-Infinity,1e-18|CISDDoc:Installation and Administrators Guide of the openBIS Data Store Server]
</pre>
</div></div></td></tr><tr><td class="confluenceTd"><p><code>groups</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>Mandatory property for validators of type <code>unique_groups</code>. Part of the <code>value-pattern</code> is a group when it's inside the brackets.</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>value-type = unique_groups
value-pattern = (a*)(b*)c*(d*)
groups = 1,3
</pre>
</div></div><p>The number of the group can be calculated as the number of '(' present in the regex before chosen group.</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>pattern: (A(B))C(D(E))
available groups:
1 (A(B))
2 (B)
3 (D(E))
4 (E)
</pre>
</div></div></td></tr></tbody></table></div><h5 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-HeaderBasedValueValidatorFactory">HeaderBasedValueValidatorFactory</h5><p>This value validator factor (fully qualified class name: <code>ch.systemsx.cisd.etlserver.validation.HeaderBasedValueValidatorFactory</code>) is a collection of column header specific validator factories. The factory is chosen by the first regular expression matching the header. HeaderBasedValueValidatorFactory understands the following properties:</p><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><th class="confluenceTh"><p>Property name</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p><code>header-types</code></p></td><td class="confluenceTd"><p>List of comma-separated unique names of value validator factories. For each name configuration properties are defined. The property names start with <code>&lt;factory name&gt;.</code>. For an example see <code>service.properties</code> example above.</p></td></tr><tr><td class="confluenceTd"><p><code>&lt;factory name&gt;.header-pattern</code></p></td><td class="confluenceTd"><p>Regular expression to be matched by column header.</p></td></tr></tbody></table></div><h3 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-RemoteDSS">Remote DSS</h3><p>More than one DSS may be connected to the same AS. In this case a DSS might request files remotely from another DSS. This can happen in FTP/SFTP server and <a href="/display/openBISDoc2010/Jython-based+Reporting+and+Processing+Plugins">aggregation/ingestion services</a>. The files downloaded from a remote DSS will be cached. By default the cache is located in the data folder of a standard installation (<code>data/dss-cache</code>). Its default maximum size is 1GB. This parameters can be changed by the following properties in <code>service.properties</code>:</p><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><th class="confluenceTh">Property Name</th><th class="confluenceTh">Default Value</th><th colspan="1" class="confluenceTh">Description</th></tr><tr><td class="confluenceTd">cache-workspace-folder</td><td class="confluenceTd">../../data/dss-cache</td><td colspan="1" class="confluenceTd">Folder which will contain the cached files.</td></tr><tr><td colspan="1" class="confluenceTd">cache-workspace-max-size</td><td colspan="1" class="confluenceTd">1024</td><td colspan="1" class="confluenceTd"><p>Maximum size of cache in MB.</p></td></tr><tr><td colspan="1" class="confluenceTd">cache-workspace-min-keeping-time</td><td colspan="1" class="confluenceTd">1 day</td><td colspan="1" class="confluenceTd"><p>Minimum time a data set is kept in the cache. Can be specified with one of the following time units: <code>ms, msec, s, sec, m, min, h, hours, d, days</code>. Default time unit is <code>sec</code>.</p></td></tr></tbody></table></div><p>Files are removed from the cache if the downloaded file would exceeds the size specified by <code>cache-workspace-max-size</code>. Removal is guided by the following rules:</p><ul><li>Removal happens after the downloading of a file which isn't in the cache.</li><li>Non or all cached files of a data set are removed.</li><li>The &quot;oldest&quot; data set is removed first. The age of a data set is determined by the last time a cached file in this data set has been requested.</li><li>Data sets are not removed when they are younger than specified by <code>cache-workspace-min-keeping-time</code>.</li></ul><p><br/></p><h3 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ETLThreads">ETL Threads</h3><p>The property <code>inputs</code> is a comma-separated list of ETL threads. Each ETL thread registers incoming data set files/folders at openBIS and store them in the data store (property <code>storeroot-dir</code>).</p><p>The name of all configuration properties for a particular ETL thread starts with <code>&lt;thread name&gt;.</code>. The following properties are understood:</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/><col/></colgroup><tbody><tr><th class="confluenceTh"><p>Property name</p></th><th class="confluenceTh"><p>Default value</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p><code>incoming-dir</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>The drop box for incoming data sets.</p></td></tr><tr><td class="confluenceTd"><p><code>incoming-data-completeness-condition</code></p></td><td class="confluenceTd"><p><code>marker-file</code></p></td><td class="confluenceTd"><p>Condition which determines when an incoming data set should be considered to be complete and ready for processing. Only the following values are allowed:</p><ul><li><code>auto-detection</code>: Assumes that data set is complete if after some quite period (global property <code>quiet-period</code>) no writing operation has been detected.</li><li><code>marker-file</code>: A marker file has been detected. The marker file should start with <code>.MARKER_is_finished_</code> followed by the name of the data set file/folder.</li></ul></td></tr><tr><td class="confluenceTd"><p><code>delete-unidentified</code></p></td><td class="confluenceTd"><p><code>false</code></p></td><td class="confluenceTd"><p>If <code>true</code> incoming data sets are deleted if they couldn't be identified. If <code>false</code> unidentified data sets are moved to the folder <code>unidentified</code> inside the store.</p></td></tr><tr><td class="confluenceTd"><p><code>data-set-info-extractor</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>Properties determine an extractor which extracts from the data set file/folder information necessary for registering in openBIS. For more details, see below.</p></td></tr><tr><td class="confluenceTd"><p><code>type-extractor</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>Extractor which extracts various type information from the data set file/folder. For more details, see below.</p></td></tr><tr><td class="confluenceTd"><p><code>storage-processor</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>Processor which processes the incoming data set file/folder and stores it in the store. For more details, see below.</p></td></tr><tr><td class="confluenceTd"><p><code>pre-registration-script</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>Path to the script that will be executed before data set registration. The script will be called with two parameters: <code>&lt;data-set-code&gt;</code> and <code>&lt;absolute-data-set-path&gt;</code> (in the incoming dropbox).</p></td></tr><tr><td class="confluenceTd"><p><code>post-registration-script</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>Path to the script that will be executed after successful data set registration. The script will be called with two parameters: <code>&lt;data-set-code&gt;</code> and <code>&lt;absolute-data-set-path&gt;</code> (in the data store).</p></td></tr><tr><td colspan="1" class="confluenceTd"><code>incoming-share-id</code></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd">Id of the incoming share the dropbox drops into. The share can be on a different disk than the incoming folder.</td></tr></tbody></table></div><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-DataSetInfoExtractor">Data Set Info Extractor</h4><p>Each thread has a property <code>&lt;thread name&gt;.data-set-info-extractor</code> which denotes a Java class implementing <code>IDataSetInfoExtractor</code>.</p><p>The most important implementation is <code>ch.systemsx.cisd.etlserver.DefaultDataSetInfoExtractor</code> which extracts most information from the name of the data set file/folder. It understands the following properties (all with prefix <code>&lt;thread name&gt;.data-set-info-extractor.</code>):</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/><col/></colgroup><tbody><tr><th class="confluenceTh"><p>Property name</p></th><th class="confluenceTh"><p>Default value</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p><code>space-code</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>Space code of the sample. If unspecified a shared sample is assumed.</p></td></tr><tr><td class="confluenceTd"><p><code>strip-file-extension</code></p></td><td class="confluenceTd"><p><code>false</code></p></td><td class="confluenceTd"><p>If <code>true</code> the file extension will be removed before extracting information from the file name.</p></td></tr><tr><td class="confluenceTd"><p><code>entity-separator</code></p></td><td class="confluenceTd"><p><code>.</code></p></td><td class="confluenceTd"><p>Character which separates entities in the file name. Whitespace characters are not allowed.</p></td></tr><tr><td class="confluenceTd"><p><code>sub-entity-separator</code></p></td><td class="confluenceTd"><p><code>&amp;</code></p></td><td class="confluenceTd"><p>Character which separates sub entities of an entity. Whitespace characters are not allowed.</p></td></tr><tr><td class="confluenceTd"><p><code>index-of-sample-code</code></p></td><td class="confluenceTd"><p><code>-1</code></p></td><td class="confluenceTd"><p>Index of the entity which is interpreted as the sample code. <strong>Data set belongs to a sample.</strong></p></td></tr><tr><td class="confluenceTd"><p><code>index-of-experiment-identifier</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>Index of the entity which is interpreted as the experiment identifier. It contains the project code, experiment code, and optionally the space code (if different from the property <code>space-code</code>). These codes are concatenated by the sub entity separator. If <code>index-of-experiment-identifier</code> is specified <code>index-of-sample-code</code> will be ignored and <strong>data set belongs directly to an eperiment.</strong></p></td></tr><tr><td class="confluenceTd"><p><code>index-of-parent-data-set-codes</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>Index of the entity which is interpreted as sequence of parent data set codes. The codes have to be separated by the sub entity separator. If not specified no parent data set code will be extracted. Parent data set codes will be ignored if <code>index-of-experiment-identifier</code> isn't spcified.</p></td></tr><tr><td class="confluenceTd"><p><code>index-of-data-producer-code</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>Index of the entity which is interpreted as the data producer code. If not specified no data producer code will be extracted.</p></td></tr><tr><td class="confluenceTd"><p><code>index-of-data-production-date</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>Index of the entity which is interpreted as the data production date. If not specified no data production date will be extracted.</p></td></tr><tr><td class="confluenceTd"><p><code>data-production-date-format</code></p></td><td class="confluenceTd"><p><code>yyyyMMddHHmmss</code></p></td><td class="confluenceTd"><p>Format of the data production date. For the correct syntax see <a class="external-link" href="http://wiki-bsse.ethz.ch//java.sun.com/j2se/1.5.0/docs/api/java/text/SimpleDateFormat.html" rel="nofollow">SimpleDateFormat</a></p></td></tr><tr><td class="confluenceTd"><p><code>data-set-properties-file-name</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>Path to a file inside a data set folder which contains data set properties. This file has to be a tab-separated file. The first line of the file should contain columns definition: <code>property</code> and <code>value</code>. Example:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedHeader panelHeader" style="border-bottom-width: 1px;"><b>data-set-properties.tsv</b></div><div class="preformattedContent panelContent">
<pre>property	value
DESCRIPTION	Description of data set series
SCHEMA_VERSION	21.3
SERIES	2009-04-01
</pre>
</div></div></td></tr></tbody></table></div><p>Entity indexes count 0, 1, 2, etc. from left and -1, -2, -3, etc. from right.</p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-TypeExtractor">Type Extractor</h4><p>Each thread has a property <code>&lt;thread name&gt;.type-extractor</code> which denotes a Java class implementing <code>ITypeExtractor</code>.</p><p><code>ch.systemsx.cisd.etlserver.SimpleTypeExtractor</code> is one of the available type extractors. Actually it doesn't extract anything from the incoming data set. It took all information from the following properties (all with prefix <code>&lt;thread name&gt;.type-extractor.</code>):</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/><col/></colgroup><tbody><tr><th class="confluenceTh"><p>Property name</p></th><th class="confluenceTh"><p>Default value</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p><code>data-set-type</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>A data set type as registered in openBIS.</p></td></tr><tr><td class="confluenceTd"><p><code>file-format-type</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>A file type as registered in openBIS.</p></td></tr><tr><td class="confluenceTd"><p><code>is-measured</code></p></td><td class="confluenceTd"><p><code>true</code></p></td><td class="confluenceTd"><p>Whether the data set is a measured one or a derived/calculated one.</p></td></tr></tbody></table></div><p><br/></p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-StorageProcessor">Storage Processor</h4><p>Each thread has a property <code>&lt;thread name&gt;.storage-processor</code> which denotes a Java class implementing <code>IStorageProcessor</code>.</p><p>The most important storage processors are <code>ch.systemsx.cisd.etlserver.DefaultStorageProcessor</code> and <code>ch.systemsx.cisd.etlserver.imsb.StorageProcessorWithDropbox</code>. The last one extends a storage processor by the additional behavior of copying the original data set file/folder to a configurable folder (drop box). It understands following properties (all with prefix <code>&lt;thread name&gt;.storage-processor.</code>):</p><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><th class="confluenceTh"><p>Property name</p></th><th class="confluenceTh"><p>Default value</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p><code>processor</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>Java class of the storage processor which will be extended.</p></td></tr><tr><td class="confluenceTd"><p><code>dropbox-dir</code></p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>Folder to which the original data set file/folder will be copied.</p></td></tr><tr><td class="confluenceTd"><p><code>entity-separator</code></p></td><td class="confluenceTd"><p><code>.</code></p></td><td class="confluenceTd"><p>Separator character used to build the following file name for the data set file/folder in the drop box: <br class="atl-forced-newline"/><code>&lt;original file name&gt;&lt;entity-separator&gt;&lt;data set code&gt;.&lt;original file type&gt;</code> <br class="atl-forced-newline"/>where <code>&lt;data set code&gt;</code> is the data set code of the data set after it has been registered in openBIS.</p></td></tr></tbody></table></div><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Datasethandler">Dataset handler</h4><p>Each thread has a property <code>&lt;thread name&gt;.dataset-handler</code> which denotes a Java class implementing <code>IDataSetHandler</code>.<br/>This property is optional, the default dataset handler is used if it is not specified.</p><p>This class allows to decide on a high level how to handle an incoming data set file or directory.<br/>It can delegate its job to the default dataset handler performing some operations beforehand or afterwards.<br/>It can also make it possible to handle datasets residing in any particular directory structure.</p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-MonitoringThreadActivity">Monitoring Thread Activity</h4><p>Each thread regularly monitors activity on a directory. In the datastore server installation directory, there is a subdirectory <code>.activity</code>/ which contains an (empty) file for each thread. The file gets 'touched' each time the thread starts a processing round. Thus, by looking at the time stamp of the according directory, an administrator can find when the last processing round of this thread took place. This can help spot long-running data ingestion processes quickly and can also help to check whether a thread is 'hanging', e.g. because of an erroneous dropbox script.</p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-MonitoringUserSessionActivity">Monitoring User Session Activity</h4><p>It's possible to monitor the growth of the openbis user sessions. If the number of sessions exceed the specify threshold, the notification is beeing sent to the admin. This behavior is controlled by two properties (defined in openbis service.properties file)</p><ul><li><code>session-notification-threshold</code> (by deafult it is 0, means the feature is off)</li><li><code>session-notification-delay-period</code> (how much time should pass beetween two notifications expressed in seconds)</li></ul><h3 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-PostRegistration">Post Registration</h3><p>It is possible to perform a sequence of tasks after registration of a data set. This is done by the maintenance task <code>ch.systemsx.cisd.etlserver.postregistration.PostRegistrationMaintenanceTask</code>. This tasks figures out freshly registered data sets and runs for each data set a sequence of configurable post registration tasks. It should be configured with a short time interval (e.g. 60 seconds) in order to do post-registration eagerly. It knows the following configuration properties:</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><tbody><tr><th class="confluenceTh"><p>Property</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p><code>interval</code></p></td><td class="confluenceTd"><p>Time interval in seconds post-registration is performed.</p></td></tr><tr><td class="confluenceTd"><p><code>cleanup-tasks-folder</code></p></td><td class="confluenceTd"><p>Path to a folder where serialized cleanup tasks are stored. If DSS crashes the cleanup tasks in this folder will be executed after start up. Default value is <code>clean-up-tasks</code></p></td></tr><tr><td class="confluenceTd"><p><code>last-seen-data-set-file</code></p></td><td class="confluenceTd"><p>Path to a file which will store the technical ID of the last data set being post-registered. The path should be outside the DSS installation in order to survive DSS update installations.</p></td></tr><tr><td class="confluenceTd"><p><code>ignore-data-sets-before-date</code></p></td><td class="confluenceTd"><p>Optional date specifying older data sets to be ignored. The format is <code>&lt;4-digits-year&gt;</code> <code> <span style="text-decoration: line-through;">&lt;2 digits month&gt;</span> </code>&lt;2-digits-day&gt;. Example: <code>2011-03-29</code></p></td></tr><tr><td class="confluenceTd"><p><code>post-registration-tasks</code></p></td><td class="confluenceTd"><p>Comma-separated list of names of post registration tasks. The tasks are performed in the order they are specified. Each name is the sub-key of the properties for the tasks. All tasks should have at least the key <code>&lt;task name&gt;.class</code> which denotes the fully-qualified name of a Java class implementing <code>ch.systemsx.cisd.etlserver.postregistration.IPostRegistrationTask</code>.</p></td></tr></tbody></table></div><p>Example:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedHeader panelHeader" style="border-bottom-width: 1px;"><b>service.properties</b></div><div class="preformattedContent panelContent">
<pre>maintenance-plugins = &lt;other maintenance plugins&gt;, post-registration

post-registration.class = ch.systemsx.cisd.etlserver.postregistration.PostRegistrationMaintenanceTask
post-registration.interval = 60
post-registration.cleanup-tasks-folder = cleanup-tasks
post-registration.ignore-data-sets-before-date = 2011-03-27
post-registration.last-seen-data-set-file = ../../last-seen-data-set
post-registration.post-registration-tasks = eager-shuffling, notifying, eager-archiving
post-registration.eager-shuffling.class = ch.systemsx.cisd.etlserver.postregistration.EagerShufflingTask
post-registration.eager-shuffling.share-finder.class = ch.systemsx.cisd.openbis.dss.generic.shared.SimpleShareFinder
post-registration.notifying.class = ch.systemsx.cisd.etlserver.postregistration.NotifyingTask
post-registration.notifying.message-template = data-set = ${data-set-code}\n\
                                               injection-volumn = ${property.inj-vol}\n
post-registration.notifying.destination-path-template = targets/ds-${data-set-code}.properties
post-registration.eager-archiving.class = ch.systemsx.cisd.etlserver.postregistration.ArchivingPostRegistrationTask
</pre>
</div></div><p>Currently three different post-registration tasks are available.</p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-EagerShufflingTask">EagerShufflingTask</h4><p>Fully qualified class name: <code>ch.systemsx.cisd.etlserver.postregistration.EagerShufflingTask</code></p><p>This task tries to find a share in the segmented store to which it will move the freshly registered data set.</p><p>Following configuration properties are recognized:</p><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><th class="confluenceTh"><p>Property</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p><code>share-finder.class</code></p></td><td class="confluenceTd"><p>Fully qualified class name of the Java class implementing <code>ch.systemsx.cisd.openbis.dss.generic.shared.IShareFinder</code>. See also section <a href="#InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ShareFinder">Share Finder</a> for available share finders.</p></td></tr><tr><td class="confluenceTd"><p><code>free-space-limit-in-MB-triggering-notification</code></p></td><td class="confluenceTd"><p>A free space threshold which leads to a notification of an admin via e-mail if this threshold has been crossed after adding a data set to a share.</p></td></tr><tr><td class="confluenceTd"><p><code>stop-on-no-share-found</code></p></td><td class="confluenceTd"><p>If <code>true</code> an exception is thrown if no share could be found. This interrupts post-registration task. That is, subsequent tasks for the same data set as well as all task for all younger data sets are not performed.</p></td></tr><tr><td colspan="1" class="confluenceTd"><pre class="p1">verify-checksum</pre></td><td colspan="1" class="confluenceTd"><p>If <span>true</span> then checksum verification is performed for the moved data sets (default: true)</p></td></tr></tbody></table></div><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-NotifyingTask">NotifyingTask</h4><p>Fully qualified class name: <code>ch.systemsx.cisd.etlserver.postregistration.NotifyingTask</code></p><p>This task writes a file with some information of the freshly registered data set.</p><p>Following configuration properties are recognized:</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><tbody><tr><th class="confluenceTh"><p>Property</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p><code>message-template</code></p></td><td class="confluenceTd"><p>A template for creating the file content.</p></td></tr><tr><td class="confluenceTd"><p><code>destination-path-template</code></p></td><td class="confluenceTd"><p>A template for creating the path of the file.</p></td></tr><tr><td class="confluenceTd"><p><code>include-dataset-type-patterns</code></p></td><td class="confluenceTd"><p>Optional. Contains comma separated patterns (java regexp). If specified then only datasets which have type matching to any of the patterns will be processed.</p></td></tr></tbody></table></div><p>The template can have place holders of the form <code>${&lt;place holder name&gt;</code>}. The following place holder name can be used: <code>data-set-code</code> and <code>property.&lt;data set property type code&gt;</code> where the data set property type code can be in lower case. For newline/tab characters in the template use <code>\n</code> and <code>\t</code>, respectively.</p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ArchivingPostRegistrationTask">ArchivingPostRegistrationTask</h4><p>Fully qualified class name: <code>ch.systemsx.cisd.etlserver.postregistration.ArchivingPostRegistrationTask</code></p><p>This task archives the freshly registered data set. The archived data set is still available. This task can be used for creating backups. Note, that <a href="#InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ArchiverPlugin">ArchiverPlugin</a> has to be configured.</p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-RequestArchivingPostRegistrationTask">RequestArchivingPostRegistrationTask</h4><p>Fully qualified class name: <code>ch.systemsx.cisd.etlserver.postregistration.RequestArchivingPostRegistrationTask</code></p><p>This task set the archiving-request flag of the freshly registered data set.</p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-SecondCopyPostRegistrationTask">SecondCopyPostRegistrationTask</h4><p>Fully qualified class name: <code>ch.systemsx.cisd.etlserver.postregistration.SecondCopyPostRegistrationTask</code></p><p>This task creates a copy of all files of the freshly registered data set.</p><p>Following configuration properties are recognized:</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><tbody><tr><th class="confluenceTh"><p>Property</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p><code>destination</code></p></td><td class="confluenceTd"><p>Path to the folder which will contain the copy. The files are created in the same folder structure as in a share folder.</p></td></tr></tbody></table></div><h3 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-PathInfoDatabase">Path Info Database</h3><p>Some data sets consists of a large number of files. Navigating in such large file set can be slow especially for NFS-based storage. In order to speed up navigation a so-called path info database can be used. Three or four things have to be configured to run it properly: A data source, a post-registration task, a deletion maintenance task, and an optional migration task. Here is an example configuration:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedHeader panelHeader" style="border-bottom-width: 1px;"><b>service.properties</b></div><div class="preformattedContent panelContent">
<pre># ---------------------------------------------------------------------------
# Data sources
data-sources = path-info-db, &lt;other data sources&gt;

# Data source for pathinfo database
path-info-db.version-holder-class = ch.systemsx.cisd.openbis.dss.generic.shared.PathInfoDatabaseVersionHolder
path-info-db.databaseEngineCode = postgresql
path-info-db.basicDatabaseName = pathinfo
path-info-db.databaseKind = productive
path-info-db.scriptFolder = datastore_server/sql
# Use this if you need to give the data source db superuser privileges
#path-info-db.owner = postgres

# ---------------------------------------------------------------------------
# Maintenance Tasks
maintenance-plugins = post-registration, path-info-deletion, path-info-feeding, &lt;other maintenance tasks&gt;

# ---------------------------------------------------------------------------
# Post registration task: Feeding path info database with freshly registered data sets.
post-registration.class = ch.systemsx.cisd.etlserver.postregistration.PostRegistrationMaintenanceTask
post-registration.interval = 30
post-registration.cleanup-tasks-folder = ../../cleanup-tasks
post-registration.ignore-data-sets-before-date = 2011-01-27
post-registration.last-seen-data-set-file = ../../last-seen-data-set-for-postregistration.txt
post-registration.post-registration-tasks = pathinfo-feeding
post-registration.pathinfo-feeding.class = ch.systemsx.cisd.etlserver.path.PathInfoDatabaseFeedingTask

# ---------------------------------------------------------------------------
# Deletion task: Remove entries from path info database after data set deletion
path-info-deletion.class = ch.systemsx.cisd.etlserver.plugins.DeleteFromExternalDBMaintenanceTask
path-info-deletion.interval = 120
path-info-deletion.data-source = path-info-db
path-info-deletion.data-set-table-name = data_sets
path-info-deletion.data-set-perm-id = CODE

# ---------------------------------------------------------------------------
# Migration task: Initial feeding of path info database with existing data sets.
path-info-feeding.class = ch.systemsx.cisd.etlserver.path.PathInfoDatabaseFeedingTask
path-info-feeding.execute-only-once = true
</pre>
</div></div><p>Remarks:</p><ul><li>The name of the data source has to be <code>path-info-db</code>.</li><li>The migration task can be removed form the configuration file after successful execution.</li></ul><h3 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-FilesystemviewoftheDSS">File system view of the DSS</h3><p>The DSS can expose its data store contents via a read-only interface that can be defined as FTP/SFTP server. The following chapters describe how to set up FTP/SFTP. The interface is exposing the same view of the dss, which has some basic structure and can be extended using properties.</p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Basichierarchy">Basic hierarchy</h4><p>The structure of the file system view is organized like a classical openbis hierarchy.<br/>/{SPACE}/{PROJECT}/{EXPERIMENT}/{DATA-SET-CODE}/{data-set-files-and-directories}</p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Plugins">Plugins</h4><p>It's possible to register plugins to the file system view. Such a plugin must be able to resolve paths into a response that is either a listing of a directory contents (files and directories) or a file to download.</p><p>To create a plugin it's necessary to create a new core plugin of type type <code style="line-height: 1.42857;">file-system-plugins</code> with definition of a custom view. If there are any file system plugins defined than each plugin's hierarchy is visible behind a separate top-level directory and &quot;DEFAULT&quot; is used for the basic hierarchy.</p><p>In plugin properties it's necessary to specify a class implementing  <a class="external-link" href="http://svnsis.ethz.ch/repos/cisd/datastore_server/trunk/source/java/ch/systemsx/cisd/openbis/dss/generic/server/fs/api/IResolverPlugin.java" rel="nofollow">IResolverPlugin</a> interface e.g</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedHeader panelHeader" style="border-bottom-width: 1px;"><b>plugin.properties</b></div><div class="preformattedContent panelContent">
<pre>resolver-class = ch.systemsx.cisd.openbis.dss.generic.server.fs.plugins.JythonResolver
code = jython-plugin
script-file = script.py
</pre>
</div></div><p>For Jython resolver it's required to implement a method <code>resolve(pathItems, context)</code> with signature as defined in <a class="external-link" href="http://svnsis.ethz.ch/repos/cisd/datastore_server/trunk/source/java/ch/systemsx/cisd/openbis/dss/generic/server/fs/api/IResolver.java" rel="nofollow">IResolver</a>.</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedHeader panelHeader" style="border-bottom-width: 1px;"><b>script.py</b></div><div class="preformattedContent panelContent">
<pre>import time
 
def resolve(subPath, context):
    api = context.getApi() # the way to access objects from openbis v3 api 
    session_token = context.getSessionToken()
	
	if len(subPath) == 0:
		# how to create a directory listing with files and directories
		directory_listing = context.createDirectoryResponse()
		directory_listing.addFile(&quot;someFile.txt&quot;, 0, time.time())
    	directory_listing.addDirectory(&quot;someDirectory&quot;, time.time())
		return directory_listing
 
	if len(subPath) == 1 and subPath[0] == &quot;someFile.txt&quot;:
		# this is how to handle request to download a file from openbis data set
		content = context.getContentProvider().asContent(&quot;DATA_SET_CODE&quot;)
		node = content.tryGetNode(&quot;original/someFile.txt&quot;);
		return context.createFileResponse(node, content)
 
	# this is how to respond to error paths
    return context.createNonExistingFileResponse(&quot;Path not supported&quot;)</pre>
</div></div><p>See <a class="external-link" href="http://svncisd.ethz.ch/repos/cisd/datastore_server/trunk/source/core-plugins/file-system-plugin-example/1/dss/file-system-plugins/" rel="nofollow" style="line-height: 1.42857;">http://svncisd.ethz.ch/repos/cisd/datastore_server/trunk/source/core-plugins/file-system-plugin-example/1/dss/file-system-plugins/</a> for examples on how to configure and implement a more complex plugin.</p><p><br/></p><div class="confluence-information-macro confluence-information-macro-information conf-macro output-block" data-hasbody="true" data-macro-name="info"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"> </span><div class="confluence-information-macro-body"><p>(Since version 20.10.4) When developing a Jython resolver script it is useful to set the property <code>ftp.resolver-dev-mode</code> in DSS <code>service.properties</code> to <code>true</code>. In this case the script is always reloaded and compiled. The default value is <code>false</code> in order to speed up normal operation where the script is loaded and compiled only once.</p></div></div><p><br/></p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Obsoletefile-systemview">Obsolete file-system view</h4><p>In the earlier versions of openbis the structure and options available were different. To see how to enable and configure old-style file system view please see this document:</p><p><a href="/display/openBISDoc2010/Old-style+file+system+view+for+FTP">Old-style file system view for FTP</a></p><p><span style="font-size: 16.0px;line-height: 1.5;">FTP / SFTP Server</span></p><p>The DSS can expose its data store contents via a read-only FTP / SFTP interface. To automatically start the internal FTP server set the configuration property <code>ftp.server.enable</code> to <code>true</code> and set one of the two properties <code>ftp.server.ftp-port</code> / <code>ftp-server.sftp-port</code> (or both) to a positive value. Please refer to the following table for a more detailed description of the possible configuration properties :</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/><col/></colgroup><tbody><tr><th class="confluenceTh"><p>Property</p></th><th class="confluenceTh"><p>Default value</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p>ftp.server.enable</p></td><td class="confluenceTd"><p>false</p></td><td class="confluenceTd"><p>When set to 'true' internal FTP and/or SFTP server will be started as part of the DSS bootstrap. If defined all 'keystore.*' properties become mandatory.</p></td></tr><tr><td class="confluenceTd"><p>ftp.server.sftp-port</p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><p>Port that the SFTP server will bind to. Needs to be set to a value other than 0 to switch on the SFTP server. SFTP is a protocol which enables secure file transfer through an SSH tunnel. This protocol is more firewall-friendly than FTP over SSL/TLS. A good value for the port is 2222.</p></td></tr><tr><td colspan="1" class="confluenceTd"><p>ftp.server.ftp-port</p></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd">Port that the FTP server will bind to. Needs to be set to a value other than 0 to switch on the FTP server. A good value for the port is 2121.</td></tr><tr><td class="confluenceTd"><p>ftp.server.port</p></td><td class="confluenceTd"><p><br/></p></td><td class="confluenceTd"><em>Deprecated</em> name for <code>ftp.server.ftp-port</code>, kept for backward-compatibility. Will be ignored if <code>ftp.server.ftp-port</code> is specified. </td></tr><tr><td class="confluenceTd"><p>ftp.server.use-ssl</p></td><td class="confluenceTd"><p>true</p></td><td class="confluenceTd"><p>Enables explicit FTP over SSL/TLS. Users can switch on connection encryption by issuing the FTP &quot;AUTH&quot; command. Similarly to the global 'use-ssl' parameter, when set to 'true' all 'keystore.*' properties become mandatory. <em>(Ignored by SFTP server.)</em></p></td></tr><tr><td class="confluenceTd"><p>ftp.server.implicit-ssl</p></td><td class="confluenceTd"><p>false</p></td><td class="confluenceTd"><p>Allows to enable implicit FTP over SSL/TLS. While this method ensures no passwords are send around unencrypted, it is not standardized by an RFC and is therefore poorly supported by clients. <em>(Ignored by SFTP server.)</em></p></td></tr><tr><td class="confluenceTd"><p>ftp.server.passivemode.port.range</p></td><td class="confluenceTd"><p>2130-2140</p></td><td class="confluenceTd"><p>Specifies a range of ports to be used when FTP server is working in passive mode. The default value is &quot;2130-2140&quot;, meaning only 11 ports will be provide to connecting clients. If there are more than 11 concurrent FTP users the configuration will have to be adjusted accordingly. <em>(Ignored by SFTP server.)</em></p></td></tr><tr><td class="confluenceTd"><p>ftp.server.activemode.enable</p></td><td class="confluenceTd"><p>false</p></td><td class="confluenceTd"><p>When set to true enables the FTP server to run in &quot;active mode&quot;. This means data connections will always go to a single pre-configured port on the server. Such a configuration can ease the server firewall administration (only one additional port has to be opened), but However it requires the client machines to be directly visible from the server. <em>(Ignored by SFTP server.)</em></p></td></tr><tr><td class="confluenceTd"><p>ftp.server.activemode.port</p></td><td class="confluenceTd"><p>2122</p></td><td class="confluenceTd"><p>FTP server active mode port number configuration. <em>(Ignored by SFTP server.)</em></p></td></tr><tr><td class="confluenceTd"><p>ftp.server.maxThreads</p></td><td class="confluenceTd"><p>25</p></td><td class="confluenceTd"><p>Maximum number of threads used by the internal FTP server. <em>(Ignored by SFTP server.)</em></p></td></tr></tbody></table></div><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ExampleFTPSclientconfiguration">Example FTPS client configuration</h4><p>If FTP over SSL/TLS is enabled, clients connecting to the FTP server must adjust their connection settings accordingly.</p><h5 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-LFTP">LFTP</h5><p><strong>In case you work outside the ETH network replace <em>bs-openbis04</em> with <em><a class="external-link" href="http://openbis-dsu.ethz.ch" rel="nofollow">openbis-dsu.ethz.ch</a></em></strong></p><p>Here the steps to setup you connection to openbis via LFTP:</p><p>1) Create a <em>config</em> file under the folder .<em>ssh/</em>:</p><div class="code panel pdl conf-macro output-block" data-hasbody="true" data-macro-name="code" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>LFTP example</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: bash; gutter: false; theme: Confluence" data-theme="Confluence">cat .ssh/config
 Host openbis-dsu.ethz.ch
  KexAlgorithms +diffie-hellman-group1-sha1
  HostKeyAlgorithms +ssh-rsa,ssh-dss  </pre>
</div></div><p>2) Add the following host in the file <em>.ssh/known_hosts</em>:</p><div class="code panel pdl conf-macro output-block" data-hasbody="true" data-macro-name="code" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>LFTP example</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: bash; gutter: false; theme: Confluence" data-theme="Confluence">[bs-openbis04.ethz.ch]:2222 ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCbAcN/0/rmcez4QTwaDPf5bMVog/LqkuyjcEqlI3RKMl+SkHIyhY/9CQLCYWq2+eITNGASseYVC2ZXJwDlRgvkYmtL/zVHUBxee8/s+DGJnqTR6TEQ2vvGFcfc6eeEktj6JkRyFS0oCfmDUWREoJP/8NzcEEWYk7MdV5xxmoBX9C6xTTP9VfWm+vUoNmozfOIywYX611lrCKMeUpdpE4DUpBX1pY4YMIvQ87SXyxhVEAJ+e8928ZUtkB0DGQ4xMHuwmjYLvO3G0Rqi5Vz0492ICYyMFOvKM4IGxf+hV4fqCRfgIBb/krXSO8WNBpzOzNlPPheM8Tdlw7irkNttp2a3
 </pre>
</div></div><p>Then connect to openBIS via LFTP: </p><div class="code panel pdl conf-macro output-block" data-hasbody="true" data-macro-name="code" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>LFTP example</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: bash; gutter: false; theme: Confluence" data-theme="Confluence">&gt; lftp sftp://&lt;username&gt;@bs-openbis04.ethz.ch:2222
Password:
lftp &lt;username&gt;@bs-openbis04.ethz.ch:~&gt; ls
dr--r--r--   1 openBIS  openBIS         0 Jul 19 09:54 BSSE_FLOWCELLS
lftp &lt;username&gt;@bs-openbis04.ethz.ch:~&gt; cd BSSE_FLOWCELLS/FLOWCELLS/2016.07
lftp &lt;username&gt;@bs-openbis04.ethz.ch:/BSSE_FLOWCELLS/FLOWCELLS/2016.07&gt; ls
dr--r--r--   1 openBIS  openBIS         0 Jul 19 09:59 20150113231613997-60446751_FASTQ_GZ
dr--r--r--   1 openBIS  openBIS         0 Jul 19 09:59 20150113231614260-60446752_FASTQ_GZ
dr--r--r--   1 openBIS  openBIS         0 Jul 19 09:59 20150113231614261-60446753_FASTQ_GZ
[..]

# Now we recursively download the data from this level
lftp &lt;username&gt;@bs-openbis04.ethz.ch:/BSSE_FLOWCELLS/FLOWCELLS/2016.07&gt; mirror
Total: 23 directories, 28 files, 0 symlinks
New: 28 files, 0 symlinks
334768712 bytes transferred in 23 seconds (13.94M/s)
To be removed: 64 directories, 45 files, 16 symlinks
lftp &lt;username&gt;@bs-openbis04.ethz.ch:/BSSE_FLOWCELLS/FLOWCELLS/2016.07&gt;

# just pick some files using regex
lftp &lt;username&gt;@bs-openbis04.ethz.ch:/BSSE_FLOWCELLS/FLOWCELLS/2016.07&gt; mirror --include-glob=&quot;*6043*&quot;
 </pre>
</div></div><p><br/></p><p>We have observed cases where the files are transferred correctly and then 'vanish' on the file system. This is due to file permissions. Please try to use the -p flag of lftp. If you are already finished and it looks like the files are not there please try to <code>chmod -R 755</code> the downloaded folder.</p><h5 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-FileZilla">FileZilla</h5><p><a class="external-link" href="http://sourceforge.net/projects/filezilla/" rel="nofollow">FileZilla</a> users should create a new site in the Site Manager:</p><p><br/></p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" draggable="false" src="/download/attachments/53745995/Screen%20Shot%202016-07-19%20at%2010.04.30.png?version=1&amp;modificationDate=1601541481360&amp;api=v2" data-image-src="/download/attachments/53745995/Screen%20Shot%202016-07-19%20at%2010.04.30.png?version=1&amp;modificationDate=1601541481360&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="53746540" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Screen Shot 2016-07-19 at 10.04.30.png" data-base-url="https://unlimited.ethz.ch" data-linked-resource-content-type="image/png" data-linked-resource-container-id="53745995" data-linked-resource-container-version="7" alt=""></span></p><p>It might also be necessary to increase to time-out from default value of 20 seconds to a larger value (e.g. 60 seconds). This is done in the global preferences:</p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-content-image-border" draggable="false" src="/download/attachments/53745995/Screen%20shot%202011-05-30%20at%202.00.59%20PM.png?version=1&amp;modificationDate=1601541481447&amp;api=v2" data-image-src="/download/attachments/53745995/Screen%20shot%202011-05-30%20at%202.00.59%20PM.png?version=1&amp;modificationDate=1601541481447&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="53746546" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Screen shot 2011-05-30 at 2.00.59 PM.png" data-base-url="https://unlimited.ethz.ch" data-linked-resource-content-type="image/png" data-linked-resource-container-id="53745995" data-linked-resource-container-version="7" alt=""></span></p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ExampleSFTPclientconfiguration">Example SFTP client configuration</h4><p>If SFTP port is configured SFTP client can be used.</p><h5 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-SFTP">SFTP</h5><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>&gt;sftp -oPort=2222 &lt;username&gt;@&lt;openbis server address&gt;

Example:
&gt;sftp -oPort=2222 john.doe@gmail.com@openbis-dsu.ethz.ch</pre>
</div></div><div class="confluence-information-macro confluence-information-macro-note conf-macro output-block" data-hasbody="true" data-macro-name="note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"> </span><div class="confluence-information-macro-body"><p>Mac OS Finder as well as most Web browsers do not support the SFTP protocol.</p></div></div><p><br/></p><h2 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ExistingDatasetHandlers">Existing Dataset Handlers</h2><h3 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-SampleAndDataSetRegistrationHandler">SampleAndDataSetRegistrationHandler</h3><p>The SampleAndDataSetRegistrationHandler can be used to register/update samples and register data sets. It takes control files in a specific format and registers or updates the samples and registers the data sets specified in the file.</p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-DSSConfiguration">DSS Configuration</h4><ul><li>The plugin can be configured to either accept registration and update requests (ACCEPT_ALL), accept only registration requests (IGNORE_EXISTING), or only update requests (REJECT_NONEXISTING)<ul><li>Default : ACCEPT_ALL</li><li>Properties Key : SAMPLE_REGISTRATION_MODE</li></ul></li></ul><ul><li>The plugin uses a regular expression to determine which files should be treated as control files. By default it uses any file with the &quot;.tsv&quot; extension, but this can be configured.<ul><li><p>Default :</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>.*\.[Tt][Ss][Vv]</pre>
</div></div></li><li>Properties Key : control-file-regex-pattern</li></ul></li></ul><ul><li>By default, the uploaded folders are deleted, even after a failure. This can be configured.<ul><li>Default : true</li><li>Properties Key : always-cleanup-after-processing</li></ul></li></ul><ul><li>The plugin treats a folder that is uploaded, but not specified in the control file, as a failure. This behavior can be configured.<ul><li>Default : true</li><li>Properties Key : unmentioned-subfolder-is-failure</li></ul></li></ul><ul><li>The plugin can be configured with a default sample type for registration. This can be overridden in the control file. If no default is specified, it must be specified in the control file.<ul><li>Default : require the sample type to be specified in the control file</li><li>Properties Key : sample-type</li><li>Control File Key : SAMPLE_TYPE</li></ul></li></ul><ul><li>The plugin can be configured with a default data set type for registration. This can be overridden in the control file. If no default is specified, it must be specified in the control file.<ul><li>Default : require the sample type to be specified in the control file</li><li>Properties Key : data-set-type</li><li>Control File Key : DATA_SET_TYPE</li></ul></li></ul><ul><li>There are certain situations in which the plugin will need to inform an administrator of a problem encountered during sample / data set registration by sending an email. By default, this email is set to all instance admins of the openBIS instance. It can, however, be configured to email a specific list of people by providing openBIS user IDs or email addresses.<ul><li>Default : send email to all instance admins</li><li>Properties Key : error-mail-recipients</li></ul></li></ul><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedHeader panelHeader" style="border-bottom-width: 1px;"><b>service.properties</b></div><div class="preformattedContent panelContent">
<pre>inputs= [...] sample-dset-reg-thread

sample-dset-reg-thread.incoming-dir = ${root-dir}/incoming-sample-dset-reg
sample-dset-reg-thread.incoming-data-completeness-condition = auto-detection
sample-dset-reg-thread.delete-unidentified = true
# The data set handler
sample-dset-reg-thread.dataset-handler = ch.systemsx.cisd.etlserver.entityregistration.SampleAndDataSetRegistrationHandler

# Controls whether samples may be registered and updated (ACCEPT_ALL), registered only (IGNORE_EXISTING), or updated only (REJECT_NONEXISTING). Default is ACCEPT_ALL
sample-dset-reg-thread.dataset-handler.sample-registration-mode = IGNORE_EXISTING

# Controls which sample type is processed by default. Omit this setting it to force it to be specified in the control file
sample-dset-reg-thread.dataset-handler.sample-type = MY_SAMPLE_TYPE

# Controls which data set type is processed by default. Omit this setting it to force it to be specified in the control file
sample-dset-reg-thread.dataset-handler.data-set-type = HCS_IMAGE

# Controls which files are treated as control files. The default is the extension .tsv. Set to .txt instead
sample-dset-reg-thread.dataset-handler.control-file-regex-pattern = .*\.[Tt][Xx][Tt]

# Data Set Type Information
sample-dset-reg-thread.type-extractor = ch.systemsx.cisd.etlserver.SimpleTypeExtractor
# The file-format-type may be overridden in the control file
sample-dset-reg-thread.type-extractor.file-format-type = TIFF
sample-dset-reg-thread.type-extractor.locator-type = RELATIVE_LOCATION

sample-dset-reg-thread.data-set-info-extractor = ch.systemsx.cisd.etlserver.DefaultDataSetInfoExtractor
sample-dset-reg-thread.storage-processor = ch.systemsx.cisd.etlserver.DefaultStorageProcessor
</pre>
</div></div><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ControlFileFormat">Control File Format</h4><p>The control file is a tab-separated-value (TSV) file. Any file in the drop box with the extension &quot;.tsv&quot; is treated as a control file.</p><p>The first non-comment line of the TSV file should be the column headers and following the headers are the metadata for samples and data sets, with each line containing the metadata for one sample/data set combination.</p><p>The headers for columns that contain sample metadata begin with &quot;S_&quot;; the headers for columns that contain data set metadata begin with &quot;D_&quot;. All headers should begin with either S_ or D_, except for a column with the header &quot;FOLDER&quot;. This specifies the (relative) path to the data to register as a data set.</p><p>In addition to the column headers, some information necessary for the registration process is contained in special comment lines that start with &quot;#!&quot; (normal comments start simply with &quot;#&quot;).</p><h5 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-RequiredComments">Required Comments</h5><ul><li>The key for the user on who's behalf the samples/data sets are being registered<ul><li>Control File Key : USERID</li></ul></li></ul><h5 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-OptionalComments(Overrides)">Optional Comments (Overrides)</h5><p>The sample type and the data set type may be provided in the control file. Values given here override those in the DSS configuration. If there are no values in the DSS configuration, then they must be provided here.</p><ul><li>The sample type for the samples<ul><li>Control File Key : SAMPLE_TYPE</li></ul></li></ul><ul><li>The data set type for the data sets<ul><li>Control File Key : DATA_SET_TYPE</li></ul></li></ul><h5 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Headers">Headers</h5><h6 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-CommonlyUsedHeaders">Commonly Used Headers</h6><p>The following column headers can be used for any type of sample and dataset:</p><ul><li>S_identifier</li><li>S_container</li><li>S_parent</li><li>S_experiment</li><li>D_code</li><li>D_file_type</li></ul><p>The headers to specify are dependent on the sample type and data set type.</p><p>Optionally, the file type for each data set can be specified by providing the following header:</p><ol><li>D_file_type</li></ol><h6 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-RequiredHeaders">Required Headers</h6><p>The following headers are required:</p><ol><li>S_identifier</li><li>FOLDER</li></ol><p>When creating new samples, the following headers are required:</p><ol><li>S_experiment</li></ol><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Example.2">Example</h4><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>	# Control Parameters
	#! GLOBAL_PROPERTIES_START
	#!   SAMPLE_TYPE = DILUTION_PLATE
	#!   DATA_SET_TYPE = HCS_IMAGE
	#!   USERID = test
	#! GLOBAL_PROPERTIES_END
	# Data
	S_identifier	S_experiment	S_OFFSET	D_COMMENT	D_GENDER	FOLDER
	/CISD/SD-TEST-1	/CISD/DEFAULT/EXP-REUSE	1	Comment 1	MALE	ds1/
	/CISD/SD-TEST-2	/CISD/DEFAULT/EXP-REUSE	2	Comment 3	MALE	ds2/
	/CISD/SD-TEST-3	/CISD/DEFAULT/EXP-REUSE	3	Comment 2	FEMALE	ds3/
</pre>
</div></div><p>To register this file, it should have a *.tsv extension (e.g. control.tsv) and should be put into the drop box along with the folders ds1, ds2, ds3.</p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ErrorConditions">Error Conditions</h4><ul><li>If any of the directories for data sets are empty, the registration of that sample/data set combination will fail.</li></ul><h3 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-SampleRegisteringDropbox">SampleRegisteringDropbox</h3><p>The SampleRegisteringDropbox can be used to register new samples without registering any data sets. Instead of data set directories, it expects control files in a specific format and registers the samples specified in this control file. The control file is the same format as used for sample batch registration in the Web GUI, augmented with a global header. The dropbox has a mode called &quot;auto id generation&quot;. In this mode, it ignores the identifiers given for the individual samples and creates new ones.</p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-DSSConfiguration.1">DSS Configuration</h4><ul><li>The plugin has to be given a directory for logging errors:<br/><ul><li>Default: none (required property)</li><li>Properties Key: error-log-dir</li></ul></li></ul><ul><li>The plugin can be given a prefix for auto-generating samples:<ul><li>Default: <code>S</code></li><li>Properties Key: sample-code-prefix</li></ul></li></ul><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedHeader panelHeader" style="border-bottom-width: 1px;"><b>service.properties</b></div><div class="preformattedContent panelContent">
<pre>inputs= [...] sample-reg-thread

sample-reg-thread.incoming-dir = ${root-dir}/incoming-sample-reg
sample-reg-thread.incoming-data-completeness-condition = auto-detection
# The data set handler
sample-reg-thread.dataset-handler = ch.systemsx.cisd.etlserver.SampleRegisteringDropbox
sample-reg-thread.dataset-handler.error-log-dir = ${root-dir}/sample-registration-errors
sample-reg-thread.dataset-handler.sample-code-prefix = ABC
</pre>
</div></div><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-ControlFileFormat.1">Control File Format</h4><p>The control file is a tab-separated-value (TSV) file with a header, and, optionally, some comments.</p><p>The first non-header and non-comment line of the TSV file should be the column headers and following the headers are the metadata for samples, with each line containing the metadata for one sample in the same format as used for the batch sample registration process in the Web GUI.</p><h5 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-RequiredControlFileKeys">Required Control File Keys</h5><ul><li>The control file has to specify the sample type of the samples to register. It is an error if this control file key is missing.<ul><li>Control File Key : SAMPLE_TYPE</li></ul></li></ul><h5 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-OptionalControlFileKeys">Optional Control File Keys</h5><ul><li>The control file can specify the space to register the new samples in. Doing so switches on auto id generation.<ul><li>Default : require the full sample identifiers, including the space, to be specified in the control file</li><li>Control File Key : DEFAULT_SPACE</li></ul></li></ul><ul><li>The key for the user on who's behalf the samples/data sets are being registered<ul><li>Default: The system user</li><li>Control File Key : USER</li></ul></li></ul><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Example.3">Example</h4><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>	# Control Parameters
	#! GLOBAL_PROPERTIES_START
	#!   SAMPLE_TYPE = GENERAL
	#!   USER = testuser
	#! GLOBAL_PROPERTIES_END
	# Data
	identifier	experiment	COMMENT
	/CISD/SD-TEST-1	/CISD/DEFAULT/EXP-REUSE
	/CISD/SD-TEST-2	/CISD/DEFAULT/EXP-REUSE
	/CISD/SD-TEST-3	/CISD/DEFAULT/EXP-REUSE
</pre>
</div></div><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-LoggingErrors">Logging Errors</h4><p>If the samples cannot be registered, e.g. because the control file has an invalid format or because one of the samples does already exist in the database, a file <code>&lt;filename&gt;_error-log.txt</code> is created in the specified <code>error-log-dir</code>. The control file is not deleted, and an error marker <code>&lt;filename&gt;_delete_me_after_correcting_errors</code> is created in the dropbox directory. If the errors in the control file are fixed, the error marker can be deleted and the control file will be automatically reprocessed.</p><h3 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-DSSRPC">DSS RPC</h3><p>DSS RPC makes it possible for clients to view and download data sets without going through the GUI and upload data sets without using drop boxes. One aspect of this service that can be configured is how uploaded data sets are processed.</p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-RPCDropboxes">RPC Dropboxes</h4><p>To have a data set of a particular data set type handed over to a specific dropbox, specify put parameters with a data set type code as the end of the key and the dropbox key as the value, e.g.:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre> dss-rpc.put.HCS_IMAGE = main-thread</pre>
</div></div><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-TheRPCDefaultDropbox">The RPC Default Dropbox</h4><p>All data set types which are not mapped, are handed over to the <em>default RPC dropbox</em>. This default RPC dropbox can be specified by setting the <code>dss-rpc.put-default</code> property to the dropbox code you want to be the default. If you don't specify a default RPC dropbox, the first dropbox will become the default RPC dropbox.</p><div class="confluence-information-macro confluence-information-macro-note conf-macro output-block" data-hasbody="true" data-macro-name="note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"> </span><div class="confluence-information-macro-body"><p>If you have more than one Data Store Server registered in an openBIS Application Server, only one DSS can be used to handle RPC Dropboxes. In this case, the property <code>dss-rpc.put.dss-code</code> needs to be set to the appropriate DSS code in the <code>service.properties</code> of the openBIS Application Server. Not doing so leads to <code>ConfigurationFailureException</code> when trying to access an RPC Dropbox.</p></div></div><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-DatasetUploaderandRPCDropboxes">Dataset Uploader and RPC Dropboxes</h4><p>The <a href="/display/openBISDoc2010/Data+Set+Uploader">Dataset Uploader</a> uploads its data to one of the RPC Dropboxes, using the decision mechanism described above.</p><h2 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-DataSetregistrationprocess">Data Set registration process</h2><h3 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-DSSRegistrationLog">DSS Registration Log</h3><p>DSS Registration Log is a mechanism to help troubleshooting problems that occur during the data set registration. For each file or directory that is placed in the incoming folder of a dropbox, a new log file is created with a name comprised of the timestamp when processing begins, the dropbox name, and the file name. This log file, along with its location in the directory structure, track progress of the registration of data and metadata contained in the file.</p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Directorystructure">Directory structure</h4><p>The logs are stored in a directory specified by the property </p><pre>    dss-registration-log-dir</pre><p>which defults to datastore_server/log-registrations.</p><p>The main log registration directory contains 3 subdirectories <em>in_process</em>, <em>succeded</em>, <em>failed</em>.<br/>The log file is initially created in the <em>in_process</em> directory and moved to <em>succeeded</em> or <em>failed</em> when registration completes.</p><p><br/></p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Thelogfile">The log file</h4><p><br/></p><p>The log file is created in the <em>in-process</em> directory when the data set registration process has started. The file is named with the current timestamp, thread name and the dataset filename.</p><p style="margin-left: 30.0px;">2012-01-18-13-33-02-837_simple-dropbox_image.png.log</p><p>While the data set is being processed, the log file is kept in the <em>in_process</em> directory. When the data set registration has finished, the file is moved to the <em>succeeded</em> or <em>failed</em> directory depending on the result of registration.</p><h4 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Logcontents">Log contents</h4><p>The log is a concise representation of the processing that happend as a result of something being placed in the dropbox. Each line of the log begins with a date and time that an event happend. Events that appear in the log include: preparation of data sets, progress of data through the various directories on the file system, and registration of metadata with the openBIS application server. In the case of failure, information about the problems that caused failure are shown in the log as well.</p><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><th class="confluenceTh">Event</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd">Prepared registration of <em>N</em> data set(s): <em>Data set codes</em></td><td class="confluenceTd">The dropbox has defined N data sets to register with openBIS. The codes of the first several data sets are shown.</td></tr><tr><td class="confluenceTd">Data has been moved to the pre-commit directory: <em>Dir</em></td><td class="confluenceTd">The data has been processed and prepared for storage. The location of the data is shown.</td></tr><tr><td class="confluenceTd">About to register metadata with AS: registrationId(<em>N</em> <em>)</em></td><td class="confluenceTd">A call will be made to the application server to register the metadata. The call has the id <em>N</em>.</td></tr><tr><td colspan="1" class="confluenceTd">Data has been registered with the openBIS Application Server.</td><td colspan="1" class="confluenceTd">The metadata has been successfully registered.</td></tr><tr><td colspan="1" class="confluenceTd">Storage processors have committed.</td><td colspan="1" class="confluenceTd">All post-processing (e.g., storage of data in a secondary data base) has completed.</td></tr><tr><td colspan="1" class="confluenceTd">Data has been moved to the final store.</td><td colspan="1" class="confluenceTd">Data is now in its designated storage location in the store directory of the DSS</td></tr><tr><td colspan="1" class="confluenceTd"><p>Storage has been confirmed in openBIS Application Server.</p></td><td colspan="1" class="confluenceTd">The application server has been informed that the data is its designated location.</td></tr></tbody></table></div><p><br/></p><p> On successful data registration log will look like this:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>2012-06-22 10:05:56 Prepared registration of 1 data set:
		20120622100556527-13696
2012-06-22 10:05:56 Data has been moved to the pre-commit directory: {directory}
2012-06-22 10:05:56 About to register metadata with AS: registrationId(99)
2012-06-22 10:05:59 Data has been registered with the openBIS Application Server.
2012-06-22 10:05:59 Storage processors have committed.
2012-06-22 10:05:59 Data has been moved to the final store.
2012-06-22 10:05:59 Storage has been confirmed in openBIS Application Server.</pre>
</div></div><p>In case of failure the log can look for instance like this:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>2012-06-20 12:14:26 Prepared registration of 1 data set:
        20120620121426786-13398
2012-06-20 12:14:26 Data has been moved to the pre-commit directory: {directory}
2012-06-20 12:14:26 About to register metadata with AS: registrationId(89)
2012-06-20 12:14:26 Error in registrating data in application server
2012-06-20 17:36:43 Starting recovery at checkpoint Precommit
2012-06-20 17:36:44 Responding to error [OPENBIS_REGISTRATION_FAILURE] by performing action LEAVE_UNTOUCHED on {directory}
2012-06-20 17:36:44 File has been left untouched {directory}
2012-06-20 17:36:44 Operations haven't been registered in AS - recovery rollback</pre>
</div></div><h3 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-DSSRegistrationFailureEmailNotifications">DSS Registration Failure Email Notifications</h3><p>Since 20.10.06 is also possible to configure a list of emails on the DSS service.properties that will get notified when failures occur. </p><div class="code panel pdl conf-macro output-block" data-hasbody="true" data-macro-name="code" style="border-width: 1px;"><div class="codeHeader panelHeader pdl" style="border-bottom-width: 1px;"><b>service.properties</b></div><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: bash; gutter: false; theme: Confluence" data-theme="Confluence"># Email addresses of people to get notifications about problems in dataset registrations
mail.addresses.dropbox-errors=admin1@localhost,admin2@localhost</pre>
</div></div><h3 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Pre-staging">Pre-staging</h3><p>The registration process can make use of the prestaging directory. When the registration task starts the hardlink copy of the original input data is created in prestaging directory, so that throught whole registration process the original input data can remain untouched. Then on the succesfull registration the original data can be removed depending on the user's configuration.</p><p>Property <code>dataset-registration-prestaging-behavior</code> can be used to define whether the registration process should make use of the the prestaging directory. It can be set to the following values:</p><ul><li><code>default</code> or <code>use_original</code> - doesn't use the prestaging directory. Use the original input file.</li><li><code>delete</code> - Use the prestaging file during the registration process, and delete original input file on successful registration</li><li><code>leave-untouched</code> - Use the prestaging file during the registration process, but leave original input file untouched on successful registration.</li></ul><h2 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-StartServer">Start Server</h2><p>The server is started as follows:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>prompt&gt; cd datastore_server
prompt&gt; ./datastore_server.sh start
</pre>
</div></div><p>If <code>mail.test.address</code> property is set a test e-mail will be sent to the specified address after successful start-up of the server.</p><h2 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-StopServer">Stop Server</h2><p>The server is stopped as follows:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>prompt&gt; cd datastore_server
prompt&gt; ./datastore_server.sh stop
</pre>
</div></div><h1 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Fix&quot;Can&#39;tconnecttoX11windowserver&quot;or&quot;Couldnotinitializeclasssun.awt.X11GraphicsEnvironment&quot;problem">Fix &quot;Can't connect to X11 window server&quot; or &quot;Could not initialize class sun.awt.X11GraphicsEnvironment&quot; problem</h1><p>Some Data Store Server plugins operate on images (e.g. by generating charts or rescaling images before they are displayed or registered).<br/>These operations do not work reliably in headless mode, thus a dummy X11 server like Xvfb needs to be installed and run on the server running the DSS.</p><p>Typical symptoms for this problems are when you see messages like</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>2010-12-10 10:34:07.406::WARN:  Error for /datastore_server/chromatogram
java.lang.NoClassDefFoundError: Could not initialize class sun.awt.X11GraphicsEnvironment
        at java.lang.Class.forName0(Native Method)
        at java.lang.Class.forName(Unknown Source)
        at java.awt.GraphicsEnvironment.getLocalGraphicsEnvironment(Unknown Source)
        at sun.awt.X11.XToolkit.&lt;clinit&gt;(Unknown Source)
        at java.lang.Class.forName0(Native Method)
        at java.lang.Class.forName(Unknown Source)
        at java.awt.Toolkit$2.run(Unknown Source)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.awt.Toolkit.getDefaultToolkit(Unknown Source)
        at sun.swing.SwingUtilities2$AATextInfo.getAATextInfo(Unknown Source)
        at javax.swing.plaf.metal.MetalLookAndFeel.initComponentDefaults(Unknown Source)
        at javax.swing.plaf.basic.BasicLookAndFeel.getDefaults(Unknown Source)
        at javax.swing.plaf.metal.MetalLookAndFeel.getDefaults(Unknown Source)
        at javax.swing.UIManager.setLookAndFeel(Unknown Source)
        at javax.swing.UIManager.setLookAndFeel(Unknown Source)
        at javax.swing.UIManager.initializeDefaultLAF(Unknown Source)
        at javax.swing.UIManager.initialize(Unknown Source)
        at javax.swing.UIManager.maybeInitialize(Unknown Source)
        at javax.swing.UIManager.getDefaults(Unknown Source)
        at javax.swing.UIManager.getColor(Unknown Source)
        at org.jfree.chart.JFreeChart.&lt;clinit&gt;(JFreeChart.java:261)
        at org.jfree.chart.ChartFactory.createXYLineChart(ChartFactory.java:1748)</pre>
</div></div><p>in <code>startup_log.txt</code>.<br/>or in DSS log messages like:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>2011-10-11 14:43:44,412 ERROR [hcs_image_raw - Incoming Data Monitor] OPERATION.DataSetStorageAlgorithmRunner - Error during dataset registertion: InternalError: Can't connect to X11 window se
rver using ':1.0' as the value of the DISPLAY variable.
java.lang.InternalError: Can't connect to X11 window server using ':1.0' as the value of the DISPLAY variable.
        at sun.awt.X11GraphicsEnvironment.initDisplay(Native Method)
        at sun.awt.X11GraphicsEnvironment.access$200(X11GraphicsEnvironment.java:62)
        at sun.awt.X11GraphicsEnvironment$1.run(X11GraphicsEnvironment.java:178)
        at java.security.AccessController.doPrivileged(Native Method)
        at sun.awt.X11GraphicsEnvironment.&lt;clinit&gt;(X11GraphicsEnvironment.java:142)
        at java.lang.Class.forName0(Native Method)
        at java.lang.Class.forName(Class.java:186)
        at java.awt.GraphicsEnvironment.getLocalGraphicsEnvironment(GraphicsEnvironment.java:82)
        at java.awt.image.BufferedImage.createGraphics(BufferedImage.java:1152)
        at java.awt.image.BufferedImage.getGraphics(BufferedImage.java:1142)
        at ch.systemsx.cisd.imagereaders.ij.ImageJReaderLibrary.createBufferedImageOfSameType(ImageJReaderLibrary.java:75)
        at ch.systemsx.cisd.imagereaders.ij.ImageJReaderLibrary.access$0(ImageJReaderLibrary.java:70)
        at ch.systemsx.cisd.imagereaders.ij.ImageJReaderLibrary$1.readImage(ImageJReaderLibrary.java:66)
        at ch.systemsx.cisd.openbis.dss.generic.shared.utils.ImageUtil$TiffImageLoader.loadWithImageJ(ImageUtil.java:119)
        at ch.systemsx.cisd.openbis.dss.generic.shared.utils.ImageUtil$TiffImageLoader.load(ImageUtil.java:107)
        at ch.systemsx.cisd.openbis.dss.generic.shared.utils.ImageUtil.loadImageGuessingLibrary(ImageUtil.java:425)
        at ch.systemsx.cisd.openbis.dss.generic.shared.utils.ImageUtil.loadImageGuessingLibrary(ImageUtil.java:398)
        at ch.systemsx.cisd.openbis.dss.generic.shared.utils.ImageUtil.loadUnchangedImage(ImageUtil.java:234)
        ...
</pre>
</div></div><p>To fix it, perform these steps (assume Redhat Linux):</p><ol><li><p>Install package xorg-x11-server-Xvfb:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>#yum install xorg-x11-server-Xvfb
in RHEL 6.3 the package is called: xorg-x11-server-Xvfb-1.7.7-29.el6.x86_64</pre>
</div></div></li><li><p>Add the line:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>export DISPLAY=:1.0</pre>
</div></div><p>to file <code>/etc/sysconfig/openbis</code>.</p></li><li>Copy the attached file <code>Xvfb</code> to <code>/etc/init.d/Xvfb</code>.</li><li><p>Enable service Xvfb:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre># chkconfig Xvfb on</pre>
</div></div></li><li><p>Start service Xvfb:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre># /etc/init.d/Xvfb start</pre>
</div></div></li><li><p>Restart openbis service:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre># /etc/init.d/openbis restart</pre>
</div></div></li></ol><p>If there are still problems add a JVM option:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>-Djava.awt.headless=true</pre>
</div></div><p>to the jetty server configuration (for DSS modify <code>sprint/datastore_server/etc/datastore_server.conf</code>).</p><h1 id="InstallationandAdministratorsGuideoftheopenBISDataStoreServer-Runtimechangestologging">Runtime changes to logging</h1><p>The script  <code>&lt;installation directory&gt;/servers/datastore-server/datastore_server.sh </code> <span>can be used to change the logging behavior of  the datastore server while the server is running.</span></p><p>The script is used like this: <span>datastore_server.sh [command] [argument]</span></p><p><span>The table below describes the possible commands and their arguments.</span></p><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><th class="confluenceTh">Command</th><th class="confluenceTh">Argument(s)</th><th class="confluenceTh">Default Value</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd">log-service-calls</td><td class="confluenceTd">'on', 'off'</td><td class="confluenceTd">'off'</td><td class="confluenceTd"><p>Turns on / off detailed service call logging.</p><p>When this feature is enabled, datastore server will log about start and end of every service call it executes <span>to file &lt;installation directory&gt;/servers/datastore_server/log/datastore_server_service_calls.txt</span></p></td></tr><tr><td class="confluenceTd">log-long-running-invocations</td><td class="confluenceTd"><span>'on', 'off'</span></td><td class="confluenceTd">'on'</td><td class="confluenceTd"><p>Turns on / off logging of long running invocations.</p><p>When this feature is enabled, datastore server will periodically create a report of all service calls that have been in execution more than 15 seconds to file <span>&lt;installation directory&gt;/servers/datastore_server/log/datastore_server_long_running_threads.txt</span> <span> </span></p></td></tr><tr><td class="confluenceTd">debug-db-connections</td><td class="confluenceTd"><span>'on', 'off'</span></td><td class="confluenceTd">'off'</td><td class="confluenceTd"><p>Turns on / off logging about database connection pool activity.</p><p>When this feature is enabled, information about every borrow and return to database connection pool is logged to datastore server main log in file <span>&lt;installation directory&gt;/servers/datastore_server/log/datastore_server_log.txt</span></p></td></tr><tr><td class="confluenceTd">log-db-connections</td><td class="confluenceTd">no argument / minimum connection age (in milliseconds)</td><td class="confluenceTd">5000</td><td class="confluenceTd"><p>When this command is executed without an argument, information about every database connection that has been borrowed from the connection pool is written into datastore server main log in file <span>&lt;installation directory&gt;/servers/datastore_server/log/datastore_server_log.txt</span></p><p>If the &quot;minimum connection age&quot; argument is specified, only connections that have been out of the pool longer than the specified time are logged. The minimum connection age value is given in milliseconds.</p></td></tr><tr><td class="confluenceTd">record-stacktrace-db-connections </td><td class="confluenceTd">'on', 'off'</td><td class="confluenceTd">'off'</td><td class="confluenceTd"><p>Turns on / off logging of stacktraces.</p><p>When this feature is enabled AND debug-db-connections is enabled, the full stack trace of the borrowing thread will be recorded with the connection pool activity logs.</p></td></tr><tr><td class="confluenceTd">log-db-connections-separate-log-file</td><td class="confluenceTd">'on', 'off'</td><td class="confluenceTd">'off'</td><td class="confluenceTd"><p>Turns on / off database connection pool logging to separate file.</p><p><span>When this feature is disabled, the database connection pool activity logging is done only to datastore server main log. When this feature is enabled, the activity logging is done ALSO to file <span>&lt;installation directory&gt;/servers/datastore_server/log/datastore_server_db_connections.txt</span> <span>.</span> </span></p></td></tr></tbody></table></div><p><span> <br/></span></p><p><span> <br/></span></p>

                
        
    
        </div>

                        
    



<div id="labels-section" class="pageSection group">
    <div class="labels-section-content content-column" entityid="53745995" entitytype="page">
	<div class="labels-content">
		
    <ul class="label-list label-list-right ">
            <li class="no-labels-message">
            No labels
        </li>
            </ul>

    </div>
</div>
</div>
        
		
            




            
        








                        
    
<div id="comments-section" class="pageSection group">
        
    



</div>
        


                
    
            
</div>

    

    




    
    

    
    
    


    
<div id="space-tools-web-items" class="hidden">
                <div data-label="Overview" data-href="/spaces/viewspacesummary.action?key=openBISDoc2010">Overview</div>
            <div data-label="Content Tools" data-href="/pages/reorderpages.action?key=openBISDoc2010">Content Tools</div>
            <div data-label="Apps" data-href="/spaces/scroll-viewport/config.action?key=openBISDoc2010#/list">Apps</div>
    </div>
        



            </main><!-- \#main -->
            
    
    
        
            
            

<div id="footer" role="contentinfo">
    <section class="footer-body">

                                                    
        

        <ul id="poweredby">
            <li class="noprint">Powered by <a href="https://www.atlassian.com/software/confluence" class="hover-footer-link" rel="nofollow">Atlassian Confluence</a> <span id='footer-build-information'>8.2.0</span></li>
            <li class="print-only">Printed by Atlassian Confluence 8.2.0</li>
            <li class="noprint"><a href="https://support.atlassian.com/confluence-server/" class="hover-footer-link" rel="nofollow">Report a bug</a></li>
            <li class="noprint"><a href="https://www.atlassian.com/company" class="hover-footer-link" rel="nofollow">Atlassian News</a></li>
        </ul>

        

        <div id="footer-logo"><a href="https://www.atlassian.com/" rel="nofollow">Atlassian</a></div>

                    
        
    </section>
</div>

    
</div>

</div><!-- \#full-height-container -->
</div><!-- \#page -->

    <span style="display:none;" id="confluence-server-performance">{"serverDuration": 246, "requestCorrelationId": "ecfe115f94652859"}</span>
</body>
</html>
    
